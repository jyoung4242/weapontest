{
  "version": 3,
  "sources": ["../../@peasy-lib/peasy-engine/dist/esm/index.mjs"],
  "sourcesContent": ["class Engine {\n    constructor(t, s) {\n        this.interval = t;\n        this.callback = s;\n        this.started = false;\n        this.paused = false;\n        this.destroyed = false;\n        this.lastTime = 0;\n        this.resetThreshold = 1e3;\n        this.timeSinceLast = 0;\n        this.accTime = 0;\n        this.oneTime = false;\n        this.isolated = false;\n        this.doStart = t => {\n            this.started = true;\n            this.startTime = t;\n            this.lastTime = t;\n            this.accTime = 0;\n            requestAnimationFrame(this.tick);\n        };\n        this.tick = t => {\n            if (!this.started || this.paused) return;\n            const s = t - this.lastTime;\n            this.lastTime = t;\n            if (s > this.resetThreshold) {\n                console.log(`Too long since last tick: ${s}ms. Resetting.`);\n                this.timeSinceLast = 0;\n                requestAnimationFrame(this.tick);\n                return;\n            }\n            this.timeSinceLast += s;\n            const i = this.call();\n            if (i instanceof Promise) void i.then((() => requestAnimationFrame(this.tick))); else requestAnimationFrame(this.tick);\n        };\n        this.call = () => {\n            if (this.timeSinceLast >= this.interval) {\n                const t = this.callback(this.interval, this.accTime);\n                this.accTime += this.interval;\n                this.timeSinceLast -= this.interval;\n                if (this.oneTime) this.destroy();\n                if (t instanceof Promise) return t.then((() => this.call())); else void this.call();\n                return true;\n            }\n            return false;\n        };\n    }\n    static create(t) {\n        if (typeof t === \"function\") t = {\n            callback: t\n        };\n        const s = t.ms ?? 1e3 / (t.fps ?? 60);\n        const i = new Engine(s, t.callback);\n        i.resetThreshold = t.resetThreshold ?? i.resetThreshold;\n        i.oneTime = t.oneTime ?? i.oneTime;\n        i.isolated = t.isolated ?? i.isolated;\n        if (!i.isolated) Engine.engines.push(i);\n        if (t.started ?? true) i.start();\n        return i;\n    }\n    static start() {\n        return Engine.engines.map((t => t.start()));\n    }\n    static stop() {\n        return Engine.engines.map((t => t.stop()));\n    }\n    static pause() {\n        return Engine.engines.map((t => t.pause()));\n    }\n    static destroy() {\n        Engine.engines.forEach((t => t.destroy()));\n    }\n    start() {\n        if (this.started && !this.paused) return false;\n        requestAnimationFrame(this.paused ? this.tick : this.doStart);\n        this.paused = false;\n        return true;\n    }\n    stop() {\n        if (!this.started) return false;\n        this.started = false;\n        this.paused = false;\n        return true;\n    }\n    pause() {\n        if (!this.started) return false;\n        this.paused = true;\n        return true;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.stop();\n        const t = Engine.engines.indexOf(this);\n        if (t >= 0) Engine.engines.splice(t, 1);\n    }\n}\n\nEngine.engines = [];\n\nexport { Engine };\n//# sourceMappingURL=index.mjs.map\n"],
  "mappings": "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",
  "names": ["t", "s"]
}
