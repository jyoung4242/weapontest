{
  "version": 3,
  "sources": ["../../@peasy-lib/peasy-states/dist/esm/index.mjs"],
  "sourcesContent": ["class State {\n    constructor(t, s) {\n        this.states = t;\n        this.name = s;\n    }\n    enter(t, ...s) {}\n    leave(t, ...s) {}\n    update(...t) {}\n}\n\nclass States {\n    constructor() {\n        this.states = new Map;\n        this.current = null;\n        this.currentParams = [];\n        this.currentTime = 0;\n    }\n    register(...t) {\n        const s = [];\n        let i = [];\n        const e = [ ...t ];\n        e.reverse();\n        for (const t of e) {\n            if (typeof t === \"string\") {\n                i.push(t);\n                continue;\n            }\n            if (i.length === 0) i = [ t.name ];\n            s.push(...i.map((s => {\n                const i = new t(this, s);\n                this.states.set(i.name, i);\n                this.states.set(i.constructor, i);\n                return i;\n            })));\n            i = [];\n        }\n        return s;\n    }\n    set(t, s = 0, ...i) {\n        const e = typeof t === \"string\" || t != null && \"prototype\" in t ? this.states.get(t) ?? null : t;\n        if ((e ?? null) == (this.current ?? null)) if (i.length === this.currentParams.length) {\n            let t = true;\n            for (let s = 0; s < i.length; s++) if (i[s] !== this.currentParams[s]) {\n                t = false;\n                break;\n            }\n            if (t) return;\n        }\n        let n;\n        let h;\n        if (this.current != null) n = this.current.leave(e, ...i);\n        if (n instanceof Promise) return n.then((() => {\n            if (e != null) h = e.enter(this.current, ...i);\n            if (h instanceof Promise) return h.then((() => {\n                this.current = e;\n                this.currentParams = [ ...i ];\n                this.currentTime = s;\n            }));\n            this.current = e;\n            this.currentParams = [ ...i ];\n            this.currentTime = s;\n        }));\n        if (e != null) h = e.enter(this.current, ...i);\n        if (h instanceof Promise) return h.then((() => {\n            this.current = e;\n            this.currentParams = [ ...i ];\n            this.currentTime = s;\n        }));\n        this.current = e;\n        this.currentParams = [ ...i ];\n        this.currentTime = s;\n    }\n    get(t) {\n        if (t != null && this.currentTime > t) this.currentTime = t;\n        return {\n            state: this.current,\n            since: this.currentTime\n        };\n    }\n    update(...t) {\n        return this.current?.update(...t);\n    }\n}\n\nexport { State, States };\n//# sourceMappingURL=index.mjs.map\n"],
  "mappings": ";;;AAAA,IAAM,QAAN,MAAY;AAAA,EACR,YAAY,GAAG,GAAG;AACd,SAAK,SAAS;AACd,SAAK,OAAO;AAAA,EAChB;AAAA,EACA,MAAM,MAAM,GAAG;AAAA,EAAC;AAAA,EAChB,MAAM,MAAM,GAAG;AAAA,EAAC;AAAA,EAChB,UAAU,GAAG;AAAA,EAAC;AAClB;AAEA,IAAM,SAAN,MAAa;AAAA,EACT,cAAc;AACV,SAAK,SAAS,oBAAI;AAClB,SAAK,UAAU;AACf,SAAK,gBAAgB,CAAC;AACtB,SAAK,cAAc;AAAA,EACvB;AAAA,EACA,YAAY,GAAG;AACX,UAAM,IAAI,CAAC;AACX,QAAI,IAAI,CAAC;AACT,UAAM,IAAI,CAAE,GAAG,CAAE;AACjB,MAAE,QAAQ;AACV,eAAWA,MAAK,GAAG;AACf,UAAI,OAAOA,OAAM,UAAU;AACvB,UAAE,KAAKA,EAAC;AACR;AAAA,MACJ;AACA,UAAI,EAAE,WAAW;AAAG,YAAI,CAAEA,GAAE,IAAK;AACjC,QAAE,KAAK,GAAG,EAAE,IAAK,CAAAC,OAAK;AAClB,cAAMC,KAAI,IAAIF,GAAE,MAAMC,EAAC;AACvB,aAAK,OAAO,IAAIC,GAAE,MAAMA,EAAC;AACzB,aAAK,OAAO,IAAIA,GAAE,aAAaA,EAAC;AAChC,eAAOA;AAAA,MACX,CAAE,CAAC;AACH,UAAI,CAAC;AAAA,IACT;AACA,WAAO;AAAA,EACX;AAAA,EACA,IAAI,GAAG,IAAI,MAAM,GAAG;AAChB,UAAM,IAAI,OAAO,MAAM,YAAY,KAAK,QAAQ,eAAe,IAAI,KAAK,OAAO,IAAI,CAAC,KAAK,OAAO;AAChG,SAAK,KAAK,UAAU,KAAK,WAAW;AAAO,UAAI,EAAE,WAAW,KAAK,cAAc,QAAQ;AACnF,YAAIF,KAAI;AACR,iBAASC,KAAI,GAAGA,KAAI,EAAE,QAAQA;AAAK,cAAI,EAAEA,EAAC,MAAM,KAAK,cAAcA,EAAC,GAAG;AACnE,YAAAD,KAAI;AACJ;AAAA,UACJ;AACA,YAAIA;AAAG;AAAA,MACX;AAAA;AACA,QAAI;AACJ,QAAI;AACJ,QAAI,KAAK,WAAW;AAAM,UAAI,KAAK,QAAQ,MAAM,GAAG,GAAG,CAAC;AACxD,QAAI,aAAa;AAAS,aAAO,EAAE,KAAM,MAAM;AAC3C,YAAI,KAAK;AAAM,cAAI,EAAE,MAAM,KAAK,SAAS,GAAG,CAAC;AAC7C,YAAI,aAAa;AAAS,iBAAO,EAAE,KAAM,MAAM;AAC3C,iBAAK,UAAU;AACf,iBAAK,gBAAgB,CAAE,GAAG,CAAE;AAC5B,iBAAK,cAAc;AAAA,UACvB,CAAE;AACF,aAAK,UAAU;AACf,aAAK,gBAAgB,CAAE,GAAG,CAAE;AAC5B,aAAK,cAAc;AAAA,MACvB,CAAE;AACF,QAAI,KAAK;AAAM,UAAI,EAAE,MAAM,KAAK,SAAS,GAAG,CAAC;AAC7C,QAAI,aAAa;AAAS,aAAO,EAAE,KAAM,MAAM;AAC3C,aAAK,UAAU;AACf,aAAK,gBAAgB,CAAE,GAAG,CAAE;AAC5B,aAAK,cAAc;AAAA,MACvB,CAAE;AACF,SAAK,UAAU;AACf,SAAK,gBAAgB,CAAE,GAAG,CAAE;AAC5B,SAAK,cAAc;AAAA,EACvB;AAAA,EACA,IAAI,GAAG;AACH,QAAI,KAAK,QAAQ,KAAK,cAAc;AAAG,WAAK,cAAc;AAC1D,WAAO;AAAA,MACH,OAAO,KAAK;AAAA,MACZ,OAAO,KAAK;AAAA,IAChB;AAAA,EACJ;AAAA,EACA,UAAU,GAAG;AA/EjB;AAgFQ,YAAO,UAAK,YAAL,mBAAc,OAAO,GAAG;AAAA,EACnC;AACJ;",
  "names": ["t", "s", "i"]
}
