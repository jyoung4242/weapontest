class KeyboardMapping {
  constructor(mappings, callback, effectMode, keymapMode) {
    this.mappings = mappings;
    this.callback = callback;
    this.effectMode = effectMode;
    this.keymapMode = keymapMode;
    if (typeof this.mappings === "string") {
      this.mappings = [this.mappings];
    }
    if (Array.isArray(this.mappings)) {
      this.mappings = [...this.mappings].reduce((mappings2, value) => {
        mappings2[value] = value;
        return mappings2;
      }, {});
    }
    for (const key in this.mappings) {
      const action = this.mappings[key];
      if (typeof action === "string") {
        this.mappings[key] = {
          action,
          repeat: true
        };
      }
      this.mappings[key].mapping = this;
    }
  }
  maps(keys) {
    return this.mappings[keys];
  }
  unmap() {
    Keyboard.unmap(this);
  }
}

const _Keyboard = class {
  static initialize(element) {
    this.element = element;
    this.element.addEventListener("keydown", this.keyChange);
    this.element.addEventListener("keyup", this.keyChange);
    return this;
  }
  static terminate() {
    this.element?.removeEventListener("keydown", this.keyChange);
    this.element?.removeEventListener("keyup", this.keyChange);
    this.element = null;
  }
  static map(mappings, callback, effectMode = "interval", keymapMode = "add") {
    const mapping = new KeyboardMapping(mappings, callback, effectMode, keymapMode);
    this.mappings.unshift(mapping);
    return mapping;
  }
  static unmap(mapping) {
    this.mappings = this.mappings.filter((m) => m !== mapping);
    for (const key of this.pressed.keys()) {
      if (this.pressed.get(key)?.keymap.mapping === mapping) {
        this.pressed.delete(key);
      }
    }
    this.lastPressed = [...this.pressed.keys()];
  }
  static resolve(keys, eventType) {
    const mapped = this.mapped(keys);
    if (mapped == null) {
      return;
    }
    if (mapped.mapping?.effectMode === "instant") {
      mapped.mapping.callback?.(mapped.action, eventType === "keydown", 0);
      return;
    }
    if (eventType === "keydown") {
      if (!this.pressed.has(keys)) {
        this.pressed.set(keys, { keymap: mapped, repeat: 0, done: false, doneIs: false });
      }
    } else if (eventType === "keyup") {
      this.pressed.delete(keys);
    }
  }
  static update(deltaTime) {
    this.pressed.forEach((mapped, key) => {
      if (mapped.repeat === 0 || mapped.keymap.repeat && mapped.repeat <= 0) {
        mapped.keymap.mapping?.callback?.(mapped.keymap.action, true, deltaTime);
        mapped.repeat += Input.rps;
      } else {
        if (!mapped.keymap.repeat) {
          if (!mapped.done) {
            mapped.done = true;
          }
        } else {
          mapped.repeat -= deltaTime * 1e3;
        }
      }
    });
    this.lastPressed.forEach((keys) => {
      if (!this.pressed.has(keys)) {
        const mapped = this.mapped(keys);
        mapped?.mapping.callback?.(mapped.action, false, deltaTime);
      }
    });
    this.lastPressed = [...this.pressed.keys()];
  }
  static mapped(keys) {
    let mapped;
    for (const mapping of this.mappings) {
      mapped = mapping.maps(keys);
      if (mapped != null || mapping.keymapMode === "replace") {
        break;
      }
    }
    return mapped;
  }
  static is(action) {
    for (const pressed of this.pressed.values()) {
      if (pressed.keymap.action !== action) {
        continue;
      }
      if (pressed.repeat === 0 || pressed.keymap.repeat && pressed.repeat <= 0) {
        return true;
      } else {
        if (!pressed.keymap.repeat && !pressed.doneIs) {
          pressed.doneIs = true;
          return true;
        }
      }
      return false;
    }
    return false;
  }
};
let Keyboard = _Keyboard;
Keyboard.mappings = [];
Keyboard.pressed = /* @__PURE__ */ new Map();
Keyboard.lastPressed = [];
Keyboard.keyChange = (event) => {
  let keys = event.key;
  if (["Control", "Alt", "Shift"].includes(keys)) {
    if (event.type === "keydown") {
      for (const pressed of _Keyboard.pressed.keys()) {
        const pressedKeys = pressed.split("+");
        if (pressedKeys.includes(keys)) {
          continue;
        }
        let modifiedPressed = pressedKeys.pop();
        for (const modifier of ["Shift", "Alt", "Control"]) {
          if (keys === modifier || pressedKeys.includes(modifier)) {
            modifiedPressed = `${modifier}+${modifiedPressed}`;
          }
        }
        _Keyboard.resolve(pressed, "keyup");
        _Keyboard.resolve(modifiedPressed, "keydown");
      }
    } else if (event.type === "keyup") {
      for (const pressed of _Keyboard.pressed.keys()) {
        const pressedKeys = pressed.split("+");
        if (!pressedKeys.includes(keys)) {
          continue;
        }
        const modifiedPressed = pressedKeys.filter((key) => key !== keys).join("+");
        _Keyboard.resolve(pressed, "keyup");
        _Keyboard.resolve(modifiedPressed, "keydown");
      }
    }
  } else {
    if (event.shiftKey) {
      keys = `Shift+${keys}`;
    }
    if (event.altKey) {
      keys = `Alt+${keys}`;
    }
    if (event.ctrlKey) {
      keys = `Control+${keys}`;
    }
    _Keyboard.resolve(keys, event.type);
  }
};

class MouseMapping {
  constructor() {
  }
  unmap() {
    Mouse.unmap(this);
  }
}

class Mouse {
  static initialize() {
    return this;
  }
  static terminate() {
  }
  static map() {
    const mapping = new MouseMapping();
    this.mappings.unshift(mapping);
    return mapping;
  }
  static unmap(mapping) {
    this.mappings = this.mappings.filter((m) => m !== mapping);
  }
  static update(deltaTime) {
  }
  static is(action) {
    return false;
  }
}
Mouse.mappings = [];

const _Input = class {
  static initialize(rps, rAF = true, element = document.body) {
    _Input.initialized = true;
    this.rps = rps;
    Keyboard.initialize(element);
    if (rAF === true) {
      let last;
      const start = (now) => {
        last = now;
        requestAnimationFrame(tick);
      };
      const tick = (now) => {
        const deltaTime = (now - last) / 1e3;
        last = now;
        _Input.update(deltaTime);
        requestAnimationFrame(tick);
      };
      requestAnimationFrame(start);
      return;
    }
    return this;
  }
  static terminate() {
    Keyboard.terminate();
  }
  static map(mappings, callback, effectMode = "interval", keymapMode = "add") {
    if (!_Input.initialized) {
      _Input.initialize(60);
    }
    return Keyboard.map(mappings, callback, effectMode, keymapMode);
  }
  static unmap(mapping) {
    if (mapping instanceof KeyboardMapping) {
      Keyboard.unmap(mapping);
    } else {
      Mouse.unmap(mapping);
    }
  }
  static update(deltaTime) {
    Keyboard.update(deltaTime);
  }
  static is(action) {
    if (!_Input.initialized) {
      _Input.initialize(60);
    }
    return Keyboard.is(action) || Mouse.is(action);
  }
};
let Input = _Input;
Input.initialized = false;

export { Input, Keyboard, KeyboardMapping };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguZGV2Lm1qcyIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2tleWJvYXJkLW1hcHBpbmcudHMiLCIuLi8uLi9zcmMva2V5Ym9hcmQudHMiLCIuLi8uLi9zcmMvbW91c2UtbWFwcGluZy50cyIsIi4uLy4uL3NyYy9tb3VzZS50cyIsIi4uLy4uL3NyYy9pbnB1dC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJS2V5TWFwcGluZywgS2V5Ym9hcmQsIEtleUNhbGxiYWNrLCBLZXlFZmZlY3RNb2RlLCBLZXltYXBNb2RlIH0gZnJvbSBcIi4va2V5Ym9hcmRcIjtcblxuZXhwb3J0IGNsYXNzIEtleWJvYXJkTWFwcGluZyB7XG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgbWFwcGluZ3M6IHN0cmluZyB8IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgSUtleU1hcHBpbmc+LFxuICAgIHB1YmxpYyBjYWxsYmFjazogS2V5Q2FsbGJhY2sgfCB1bmRlZmluZWQsXG4gICAgcHVibGljIGVmZmVjdE1vZGU6IEtleUVmZmVjdE1vZGUsXG4gICAgcHVibGljIGtleW1hcE1vZGU6IEtleW1hcE1vZGUsXG4gICkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5tYXBwaW5ncyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMubWFwcGluZ3MgPSBbdGhpcy5tYXBwaW5nc107XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMubWFwcGluZ3MpKSB7XG4gICAgICB0aGlzLm1hcHBpbmdzID0gWy4uLnRoaXMubWFwcGluZ3NdLnJlZHVjZSgobWFwcGluZ3MsIHZhbHVlKSA9PiB7XG4gICAgICAgIChtYXBwaW5ncyBhcyBhbnkpW3ZhbHVlXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gbWFwcGluZ3M7XG4gICAgICB9LCB7fSk7XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMubWFwcGluZ3MpIHtcbiAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMubWFwcGluZ3Nba2V5XTtcbiAgICAgIGlmICh0eXBlb2YgYWN0aW9uID09PSAnc3RyaW5nJykge1xuICAgICAgICB0aGlzLm1hcHBpbmdzW2tleV0gPSB7XG4gICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgcmVwZWF0OiB0cnVlLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgdGhpcy5tYXBwaW5nc1trZXldLm1hcHBpbmcgPSB0aGlzO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBtYXBzKGtleXM6IHN0cmluZyk6IElLZXlNYXBwaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gKHRoaXMubWFwcGluZ3MgYXMgYW55KVtrZXlzXTtcbiAgfVxuXG4gIHB1YmxpYyB1bm1hcCgpOiB2b2lkIHtcbiAgICBLZXlib2FyZC51bm1hcCh0aGlzKTtcbiAgfVxuXG4gIC8vIHB1YmxpYyBhZGRNYXBwaW5nKGtleXM6IHN0cmluZyB8IHN0cmluZ1tdLCBjYWxsYmFjazogS2V5Q2FsbGJhY2spIHtcbiAgLy8gICBpZiAoIUFycmF5LmlzQXJyYXkoa2V5cykpIHtcbiAgLy8gICAgIGtleXMgPSBba2V5c107XG4gIC8vICAgfVxuICAvLyAgIGtleXMuZm9yRWFjaChrZXkgPT4gdGhpcy5tYXBwaW5ncy5zZXQoa2V5LCBjYWxsYmFjaykpO1xuICAvLyB9XG4gIC8vIHB1YmxpYyByZW1vdmVNYXBwaW5nKGtleTogc3RyaW5nKSB7XG4gIC8vICAgdGhpcy5tYXBwaW5ncy5kZWxldGUoa2V5KTtcbiAgLy8gfVxufVxuIiwiaW1wb3J0IHsgSW5wdXQgfSBmcm9tIFwiLi9pbnB1dFwiO1xuaW1wb3J0IHsgS2V5Ym9hcmRNYXBwaW5nIH0gZnJvbSBcIi4va2V5Ym9hcmQtbWFwcGluZ1wiO1xuXG5leHBvcnQgdHlwZSBLZXlDYWxsYmFjayA9IChrZXk6IHN0cmluZywgcHJlc3NlZDogYm9vbGVhbiwgZGVsdGFUaW1lOiBudW1iZXIpID0+IHZvaWQ7XG5leHBvcnQgdHlwZSBLZXltYXBNb2RlID0gJ2FkZCcgfCAncmVwbGFjZSc7XG5leHBvcnQgdHlwZSBLZXlFZmZlY3RNb2RlID0gJ2luc3RhbnQnIHwgJ2ludGVydmFsJztcblxuZXhwb3J0IGludGVyZmFjZSBJS2V5TWFwcGluZyB7XG4gIGFjdGlvbjogc3RyaW5nO1xuICByZXBlYXQ6IGJvb2xlYW47XG4gIG1hcHBpbmc/OiBLZXlib2FyZE1hcHBpbmc7XG59XG4vLyBUT0RPOiBBZGQgc3VwcG9ydCBmb3IgbXVsdGlwbGUga2V5cyBmb3Igb25lIGFjdGlvblxuZXhwb3J0IGNsYXNzIEtleWJvYXJkIHtcbiAgcHJpdmF0ZSBzdGF0aWMgZWxlbWVudDogSFRNTEVsZW1lbnQgfCBudWxsO1xuICBwcml2YXRlIHN0YXRpYyBtYXBwaW5nczogS2V5Ym9hcmRNYXBwaW5nW10gPSBbXTtcbiAgLy8gcHJpdmF0ZSBzdGF0aWMgbWFwcGluZ3M6IE1hcDxzdHJpbmcsIEtleUNhbGxiYWNrPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgcHJlc3NlZDogTWFwPHN0cmluZywgeyBrZXltYXA6IElLZXlNYXBwaW5nLCByZXBlYXQ6IG51bWJlciwgZG9uZTogYm9vbGVhbiwgZG9uZUlzOiBib29sZWFuIH0+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHN0YXRpYyBsYXN0UHJlc3NlZDogc3RyaW5nW10gPSBbXTtcblxuICBwdWJsaWMgc3RhdGljIGluaXRpYWxpemUoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlDaGFuZ2UpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMua2V5Q2hhbmdlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdGVybWluYXRlKCkge1xuICAgIHRoaXMuZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5Q2hhbmdlKTtcbiAgICB0aGlzLmVsZW1lbnQ/LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5rZXlDaGFuZ2UpO1xuICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG1hcChtYXBwaW5nczogc3RyaW5nIHwgc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBJS2V5TWFwcGluZz4sIGNhbGxiYWNrPzogS2V5Q2FsbGJhY2ssIGVmZmVjdE1vZGU6IEtleUVmZmVjdE1vZGUgPSAnaW50ZXJ2YWwnLCBrZXltYXBNb2RlOiBLZXltYXBNb2RlID0gJ2FkZCcpOiBLZXlib2FyZE1hcHBpbmcge1xuICAgIGNvbnN0IG1hcHBpbmcgPSBuZXcgS2V5Ym9hcmRNYXBwaW5nKG1hcHBpbmdzLCBjYWxsYmFjaywgZWZmZWN0TW9kZSwga2V5bWFwTW9kZSk7XG4gICAgdGhpcy5tYXBwaW5ncy51bnNoaWZ0KG1hcHBpbmcpO1xuICAgIHJldHVybiBtYXBwaW5nO1xuICB9XG4gIHB1YmxpYyBzdGF0aWMgdW5tYXAobWFwcGluZzogS2V5Ym9hcmRNYXBwaW5nKTogdm9pZCB7XG4gICAgdGhpcy5tYXBwaW5ncyA9IHRoaXMubWFwcGluZ3MuZmlsdGVyKG0gPT4gbSAhPT0gbWFwcGluZyk7XG4gICAgZm9yIChjb25zdCBrZXkgb2YgdGhpcy5wcmVzc2VkLmtleXMoKSkge1xuICAgICAgaWYgKHRoaXMucHJlc3NlZC5nZXQoa2V5KT8ua2V5bWFwLm1hcHBpbmcgPT09IG1hcHBpbmcpIHtcbiAgICAgICAgdGhpcy5wcmVzc2VkLmRlbGV0ZShrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmxhc3RQcmVzc2VkID0gWy4uLnRoaXMucHJlc3NlZC5rZXlzKCldO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBrZXlDaGFuZ2UgPSAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkID0+IHtcbiAgICBsZXQga2V5cyA9IGV2ZW50LmtleTtcbiAgICBpZiAoWydDb250cm9sJywgJ0FsdCcsICdTaGlmdCddLmluY2x1ZGVzKGtleXMpKSB7XG4gICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2tleWRvd24nKSB7XG4gICAgICAgIGZvciAoY29uc3QgcHJlc3NlZCBvZiB0aGlzLnByZXNzZWQua2V5cygpKSB7XG4gICAgICAgICAgY29uc3QgcHJlc3NlZEtleXMgPSBwcmVzc2VkLnNwbGl0KCcrJyk7XG4gICAgICAgICAgaWYgKHByZXNzZWRLZXlzLmluY2x1ZGVzKGtleXMpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IG1vZGlmaWVkUHJlc3NlZCA9IHByZXNzZWRLZXlzLnBvcCgpO1xuICAgICAgICAgIGZvciAoY29uc3QgbW9kaWZpZXIgb2YgWydTaGlmdCcsICdBbHQnLCAnQ29udHJvbCddKSB7XG4gICAgICAgICAgICBpZiAoa2V5cyA9PT0gbW9kaWZpZXIgfHwgcHJlc3NlZEtleXMuaW5jbHVkZXMobW9kaWZpZXIpKSB7XG4gICAgICAgICAgICAgIG1vZGlmaWVkUHJlc3NlZCA9IGAke21vZGlmaWVyfSske21vZGlmaWVkUHJlc3NlZH1gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIEtleWJvYXJkLnJlc29sdmUocHJlc3NlZCwgJ2tleXVwJyk7XG4gICAgICAgICAgS2V5Ym9hcmQucmVzb2x2ZShtb2RpZmllZFByZXNzZWQgYXMgc3RyaW5nLCAna2V5ZG93bicpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09ICdrZXl1cCcpIHtcbiAgICAgICAgZm9yIChjb25zdCBwcmVzc2VkIG9mIHRoaXMucHJlc3NlZC5rZXlzKCkpIHtcbiAgICAgICAgICBjb25zdCBwcmVzc2VkS2V5cyA9IHByZXNzZWQuc3BsaXQoJysnKTtcbiAgICAgICAgICBpZiAoIXByZXNzZWRLZXlzLmluY2x1ZGVzKGtleXMpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbW9kaWZpZWRQcmVzc2VkID0gcHJlc3NlZEtleXMuZmlsdGVyKGtleSA9PiBrZXkgIT09IGtleXMpLmpvaW4oJysnKTtcblxuICAgICAgICAgIEtleWJvYXJkLnJlc29sdmUocHJlc3NlZCwgJ2tleXVwJyk7XG4gICAgICAgICAgS2V5Ym9hcmQucmVzb2x2ZShtb2RpZmllZFByZXNzZWQsICdrZXlkb3duJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGV2ZW50LnNoaWZ0S2V5KSB7XG4gICAgICAgIGtleXMgPSBgU2hpZnQrJHtrZXlzfWA7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQuYWx0S2V5KSB7XG4gICAgICAgIGtleXMgPSBgQWx0KyR7a2V5c31gO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAga2V5cyA9IGBDb250cm9sKyR7a2V5c31gO1xuICAgICAgfVxuICAgICAgS2V5Ym9hcmQucmVzb2x2ZShrZXlzLCBldmVudC50eXBlKTtcbiAgICB9XG4gIH07XG5cbiAgcHVibGljIHN0YXRpYyByZXNvbHZlKGtleXM6IHN0cmluZywgZXZlbnRUeXBlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBtYXBwZWQgPSB0aGlzLm1hcHBlZChrZXlzKTtcbiAgICBpZiAobWFwcGVkID09IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobWFwcGVkLm1hcHBpbmc/LmVmZmVjdE1vZGUgPT09ICdpbnN0YW50Jykge1xuICAgICAgbWFwcGVkLm1hcHBpbmcuY2FsbGJhY2s/LihtYXBwZWQuYWN0aW9uLCBldmVudFR5cGUgPT09ICdrZXlkb3duJywgMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2tleWRvd24nKSB7XG4gICAgICBpZiAoIXRoaXMucHJlc3NlZC5oYXMoa2V5cykpIHtcbiAgICAgICAgdGhpcy5wcmVzc2VkLnNldChrZXlzLCB7IGtleW1hcDogbWFwcGVkLCByZXBlYXQ6IDAsIGRvbmU6IGZhbHNlLCBkb25lSXM6IGZhbHNlIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZXZlbnRUeXBlID09PSAna2V5dXAnKSB7XG4gICAgICB0aGlzLnByZXNzZWQuZGVsZXRlKGtleXMpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgdGhpcy5wcmVzc2VkLmZvckVhY2goKG1hcHBlZCwga2V5KSA9PiB7XG4gICAgICBpZiAobWFwcGVkLnJlcGVhdCA9PT0gMCB8fCAobWFwcGVkLmtleW1hcC5yZXBlYXQgJiYgbWFwcGVkLnJlcGVhdCA8PSAwKSkge1xuICAgICAgICBtYXBwZWQua2V5bWFwLm1hcHBpbmc/LmNhbGxiYWNrPy4obWFwcGVkLmtleW1hcC5hY3Rpb24sIHRydWUsIGRlbHRhVGltZSk7XG4gICAgICAgIG1hcHBlZC5yZXBlYXQgKz0gSW5wdXQucnBzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ05PIFJFUEVBVCcsIG1hcHBlZC5yZXBlYXQpO1xuICAgICAgICBpZiAoIW1hcHBlZC5rZXltYXAucmVwZWF0KSB7XG4gICAgICAgICAgaWYgKCFtYXBwZWQuZG9uZSkge1xuICAgICAgICAgICAgLy8gbWFwcGVkLmtleW1hcC5tYXBwaW5nLmNhbGxiYWNrKG1hcHBlZC5rZXltYXAuYWN0aW9uLCBmYWxzZSwgZGVsdGFUaW1lKTtcbiAgICAgICAgICAgIG1hcHBlZC5kb25lID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWFwcGVkLnJlcGVhdCAtPSBkZWx0YVRpbWUgKiAxMDAwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5sYXN0UHJlc3NlZC5mb3JFYWNoKGtleXMgPT4ge1xuICAgICAgaWYgKCF0aGlzLnByZXNzZWQuaGFzKGtleXMpKSB7XG4gICAgICAgIGNvbnN0IG1hcHBlZCA9IHRoaXMubWFwcGVkKGtleXMpO1xuICAgICAgICBtYXBwZWQ/Lm1hcHBpbmchLmNhbGxiYWNrPy4obWFwcGVkLmFjdGlvbiwgZmFsc2UsIGRlbHRhVGltZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5sYXN0UHJlc3NlZCA9IFsuLi50aGlzLnByZXNzZWQua2V5cygpXTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbWFwcGVkKGtleXM6IHN0cmluZyk6IElLZXlNYXBwaW5nIHwgdW5kZWZpbmVkIHtcbiAgICBsZXQgbWFwcGVkO1xuICAgIGZvciAoY29uc3QgbWFwcGluZyBvZiB0aGlzLm1hcHBpbmdzKSB7XG4gICAgICBtYXBwZWQgPSBtYXBwaW5nLm1hcHMoa2V5cyk7XG4gICAgICBpZiAobWFwcGVkICE9IG51bGwgfHwgbWFwcGluZy5rZXltYXBNb2RlID09PSAncmVwbGFjZScpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXBwZWQ7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGlzKGFjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgZm9yIChjb25zdCBwcmVzc2VkIG9mIHRoaXMucHJlc3NlZC52YWx1ZXMoKSkge1xuICAgICAgaWYgKHByZXNzZWQua2V5bWFwLmFjdGlvbiAhPT0gYWN0aW9uKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHByZXNzZWQucmVwZWF0ID09PSAwIHx8IChwcmVzc2VkLmtleW1hcC5yZXBlYXQgJiYgcHJlc3NlZC5yZXBlYXQgPD0gMCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXByZXNzZWQua2V5bWFwLnJlcGVhdCAmJiAhcHJlc3NlZC5kb25lSXMpIHtcbiAgICAgICAgICBwcmVzc2VkLmRvbmVJcyA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG4iLCJpbXBvcnQgeyBNb3VzZSB9IGZyb20gXCIuL21vdXNlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTW91c2VNYXBwaW5nIHtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoXHJcbiAgKSB7XHJcbiAgfVxyXG4gIHB1YmxpYyB1bm1hcCgpOiB2b2lkIHtcclxuICAgIE1vdXNlLnVubWFwKHRoaXMpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBNb3VzZU1hcHBpbmcgfSBmcm9tIFwiLi9tb3VzZS1tYXBwaW5nXCI7XHJcblxyXG5leHBvcnQgdHlwZSBNb3VzZUNhbGxiYWNrID0gKGtleTogc3RyaW5nLCBwcmVzc2VkOiBib29sZWFuLCBkZWx0YVRpbWU6IG51bWJlcikgPT4gdm9pZDtcclxuZXhwb3J0IHR5cGUgTW91c2VFZmZlY3RNb2RlID0gJ2luc3RhbnQnIHwgJ2ludGVydmFsJztcclxuXHJcbmV4cG9ydCBjbGFzcyBNb3VzZSB7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgbWFwcGluZ3M6IE1vdXNlTWFwcGluZ1tdID0gW107XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgaW5pdGlhbGl6ZSgpIHtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyB0ZXJtaW5hdGUoKSB7IH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBtYXAoKTogTW91c2VNYXBwaW5nIHtcclxuICAgIGNvbnN0IG1hcHBpbmcgPSBuZXcgTW91c2VNYXBwaW5nKCk7XHJcbiAgICB0aGlzLm1hcHBpbmdzLnVuc2hpZnQobWFwcGluZyk7XHJcbiAgICByZXR1cm4gbWFwcGluZztcclxuICB9XHJcbiAgcHVibGljIHN0YXRpYyB1bm1hcChtYXBwaW5nOiBNb3VzZU1hcHBpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMubWFwcGluZ3MgPSB0aGlzLm1hcHBpbmdzLmZpbHRlcihtID0+IG0gIT09IG1hcHBpbmcpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyB1cGRhdGUoZGVsdGFUaW1lOiBudW1iZXIpIHsgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGlzKGFjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElLZXlNYXBwaW5nLCBLZXlib2FyZCwgS2V5Q2FsbGJhY2ssIEtleUVmZmVjdE1vZGUsIEtleW1hcE1vZGUgfSBmcm9tIFwiLi9rZXlib2FyZFwiO1xuaW1wb3J0IHsgS2V5Ym9hcmRNYXBwaW5nIH0gZnJvbSBcIi4va2V5Ym9hcmQtbWFwcGluZ1wiO1xuaW1wb3J0IHsgTW91c2UgfSBmcm9tIFwiLi9tb3VzZVwiO1xuaW1wb3J0IHsgTW91c2VNYXBwaW5nIH0gZnJvbSBcIi4vbW91c2UtbWFwcGluZ1wiO1xuXG5leHBvcnQgdHlwZSBJbnB1dENhbGxiYWNrID0gS2V5Q2FsbGJhY2s7XG5leHBvcnQgdHlwZSBJbnB1dEVmZmVjdE1vZGUgPSBLZXlFZmZlY3RNb2RlO1xuXG5leHBvcnQgY2xhc3MgSW5wdXQge1xuICBwcml2YXRlIHN0YXRpYyBpbml0aWFsaXplZCA9IGZhbHNlO1xuICBwdWJsaWMgc3RhdGljIHJwczogbnVtYmVyO1xuXG4gIHB1YmxpYyBzdGF0aWMgaW5pdGlhbGl6ZShycHM6IG51bWJlciwgckFGID0gdHJ1ZSwgZWxlbWVudCA9IGRvY3VtZW50LmJvZHkpIHtcbiAgICBJbnB1dC5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgdGhpcy5ycHMgPSBycHM7XG4gICAgS2V5Ym9hcmQuaW5pdGlhbGl6ZShlbGVtZW50KTtcbiAgICBNb3VzZS5pbml0aWFsaXplKCk7XG5cbiAgICBpZiAockFGID09PSB0cnVlKSB7XG4gICAgICBsZXQgbGFzdDogbnVtYmVyO1xuICAgICAgY29uc3Qgc3RhcnQgPSAobm93OiBudW1iZXIpID0+IHtcbiAgICAgICAgbGFzdCA9IG5vdztcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spO1xuICAgICAgfTtcbiAgICAgIGNvbnN0IHRpY2sgPSAobm93OiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgZGVsdGFUaW1lID0gKG5vdyAtIGxhc3QpIC8gMTAwMDtcbiAgICAgICAgbGFzdCA9IG5vdztcbiAgICAgICAgSW5wdXQudXBkYXRlKGRlbHRhVGltZSk7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTtcbiAgICAgIH07XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc3RhcnQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdGVybWluYXRlKCkge1xuICAgIEtleWJvYXJkLnRlcm1pbmF0ZSgpO1xuICAgIE1vdXNlLnRlcm1pbmF0ZSgpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBtYXAobWFwcGluZ3M6IGFueSwgY2FsbGJhY2s/OiBJbnB1dENhbGxiYWNrLCBlZmZlY3RNb2RlOiBJbnB1dEVmZmVjdE1vZGUgPSAnaW50ZXJ2YWwnLCBrZXltYXBNb2RlOiBLZXltYXBNb2RlID0gJ2FkZCcpOiBLZXlib2FyZE1hcHBpbmcge1xuICAgIGlmICghSW5wdXQuaW5pdGlhbGl6ZWQpIHtcbiAgICAgIElucHV0LmluaXRpYWxpemUoNjApO1xuICAgIH1cbiAgICByZXR1cm4gS2V5Ym9hcmQubWFwKG1hcHBpbmdzLCBjYWxsYmFjaywgZWZmZWN0TW9kZSwga2V5bWFwTW9kZSk7XG4gIH1cbiAgcHVibGljIHN0YXRpYyB1bm1hcChtYXBwaW5nOiBLZXlib2FyZE1hcHBpbmcgfCBNb3VzZU1hcHBpbmcpOiB2b2lkIHtcbiAgICBpZiAobWFwcGluZyBpbnN0YW5jZW9mIEtleWJvYXJkTWFwcGluZykge1xuICAgICAgS2V5Ym9hcmQudW5tYXAobWFwcGluZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIE1vdXNlLnVubWFwKG1hcHBpbmcpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgS2V5Ym9hcmQudXBkYXRlKGRlbHRhVGltZSk7XG4gICAgTW91c2UudXBkYXRlKGRlbHRhVGltZSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGlzKGFjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgaWYgKCFJbnB1dC5pbml0aWFsaXplZCkge1xuICAgICAgSW5wdXQuaW5pdGlhbGl6ZSg2MCk7XG4gICAgfVxuICAgIHJldHVybiBLZXlib2FyZC5pcyhhY3Rpb24pIHx8IE1vdXNlLmlzKGFjdGlvbik7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJtYXBwaW5ncyJdLCJtYXBwaW5ncyI6IkFBRU8sTUFBTSxlQUFnQixDQUFBO0FBQUEsRUFDcEIsV0FDRSxDQUFBLFFBQUEsRUFDQSxRQUNBLEVBQUEsVUFBQSxFQUNBLFVBQ1AsRUFBQTtBQUpPLElBQUEsSUFBQSxDQUFBLFFBQUEsR0FBQSxRQUFBLENBQUE7QUFDQSxJQUFBLElBQUEsQ0FBQSxRQUFBLEdBQUEsUUFBQSxDQUFBO0FBQ0EsSUFBQSxJQUFBLENBQUEsVUFBQSxHQUFBLFVBQUEsQ0FBQTtBQUNBLElBQUEsSUFBQSxDQUFBLFVBQUEsR0FBQSxVQUFBLENBQUE7QUFFUCxJQUFJLElBQUEsT0FBTyxJQUFLLENBQUEsUUFBQSxLQUFhLFFBQVUsRUFBQTtBQUNyQyxNQUFLLElBQUEsQ0FBQSxRQUFBLEdBQVcsQ0FBQyxJQUFBLENBQUssUUFBUSxDQUFBLENBQUE7QUFBQSxLQUNoQztBQUNBLElBQUEsSUFBSSxLQUFNLENBQUEsT0FBQSxDQUFRLElBQUssQ0FBQSxRQUFRLENBQUcsRUFBQTtBQUNoQyxNQUFLLElBQUEsQ0FBQSxRQUFBLEdBQVcsQ0FBQyxHQUFHLElBQUEsQ0FBSyxRQUFRLENBQUUsQ0FBQSxNQUFBLENBQU8sQ0FBQ0EsU0FBQUEsRUFBVSxLQUFVLEtBQUE7QUFDN0Qs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
