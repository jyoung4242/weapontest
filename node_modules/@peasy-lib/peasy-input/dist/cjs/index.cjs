'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

class KeyboardMapping {
  constructor(mappings, callback, effectMode, keymapMode) {
    this.mappings = mappings;
    this.callback = callback;
    this.effectMode = effectMode;
    this.keymapMode = keymapMode;
    if (typeof this.mappings === "string") {
      this.mappings = [this.mappings];
    }
    if (Array.isArray(this.mappings)) {
      this.mappings = [...this.mappings].reduce((mappings2, value) => {
        mappings2[value] = value;
        return mappings2;
      }, {});
    }
    for (const key in this.mappings) {
      const action = this.mappings[key];
      if (typeof action === "string") {
        this.mappings[key] = {
          action,
          repeat: true
        };
      }
      this.mappings[key].mapping = this;
    }
  }
  maps(keys) {
    return this.mappings[keys];
  }
  unmap() {
    Keyboard.unmap(this);
  }
}

const _Keyboard = class {
  static initialize(element) {
    this.element = element;
    this.element.addEventListener("keydown", this.keyChange);
    this.element.addEventListener("keyup", this.keyChange);
    return this;
  }
  static terminate() {
    this.element?.removeEventListener("keydown", this.keyChange);
    this.element?.removeEventListener("keyup", this.keyChange);
    this.element = null;
  }
  static map(mappings, callback, effectMode = "interval", keymapMode = "add") {
    const mapping = new KeyboardMapping(mappings, callback, effectMode, keymapMode);
    this.mappings.unshift(mapping);
    return mapping;
  }
  static unmap(mapping) {
    this.mappings = this.mappings.filter((m) => m !== mapping);
    for (const key of this.pressed.keys()) {
      if (this.pressed.get(key)?.keymap.mapping === mapping) {
        this.pressed.delete(key);
      }
    }
    this.lastPressed = [...this.pressed.keys()];
  }
  static resolve(keys, eventType) {
    const mapped = this.mapped(keys);
    if (mapped == null) {
      return;
    }
    if (mapped.mapping?.effectMode === "instant") {
      mapped.mapping.callback?.(mapped.action, eventType === "keydown", 0);
      return;
    }
    if (eventType === "keydown") {
      if (!this.pressed.has(keys)) {
        this.pressed.set(keys, { keymap: mapped, repeat: 0, done: false, doneIs: false });
      }
    } else if (eventType === "keyup") {
      this.pressed.delete(keys);
    }
  }
  static update(deltaTime) {
    this.pressed.forEach((mapped, key) => {
      if (mapped.repeat === 0 || mapped.keymap.repeat && mapped.repeat <= 0) {
        mapped.keymap.mapping?.callback?.(mapped.keymap.action, true, deltaTime);
        mapped.repeat += Input.rps;
      } else {
        if (!mapped.keymap.repeat) {
          if (!mapped.done) {
            mapped.done = true;
          }
        } else {
          mapped.repeat -= deltaTime * 1e3;
        }
      }
    });
    this.lastPressed.forEach((keys) => {
      if (!this.pressed.has(keys)) {
        const mapped = this.mapped(keys);
        mapped?.mapping.callback?.(mapped.action, false, deltaTime);
      }
    });
    this.lastPressed = [...this.pressed.keys()];
  }
  static mapped(keys) {
    let mapped;
    for (const mapping of this.mappings) {
      mapped = mapping.maps(keys);
      if (mapped != null || mapping.keymapMode === "replace") {
        break;
      }
    }
    return mapped;
  }
  static is(action) {
    for (const pressed of this.pressed.values()) {
      if (pressed.keymap.action !== action) {
        continue;
      }
      if (pressed.repeat === 0 || pressed.keymap.repeat && pressed.repeat <= 0) {
        return true;
      } else {
        if (!pressed.keymap.repeat && !pressed.doneIs) {
          pressed.doneIs = true;
          return true;
        }
      }
      return false;
    }
    return false;
  }
};
let Keyboard = _Keyboard;
Keyboard.mappings = [];
Keyboard.pressed = /* @__PURE__ */ new Map();
Keyboard.lastPressed = [];
Keyboard.keyChange = (event) => {
  let keys = event.key;
  if (["Control", "Alt", "Shift"].includes(keys)) {
    if (event.type === "keydown") {
      for (const pressed of _Keyboard.pressed.keys()) {
        const pressedKeys = pressed.split("+");
        if (pressedKeys.includes(keys)) {
          continue;
        }
        let modifiedPressed = pressedKeys.pop();
        for (const modifier of ["Shift", "Alt", "Control"]) {
          if (keys === modifier || pressedKeys.includes(modifier)) {
            modifiedPressed = `${modifier}+${modifiedPressed}`;
          }
        }
        _Keyboard.resolve(pressed, "keyup");
        _Keyboard.resolve(modifiedPressed, "keydown");
      }
    } else if (event.type === "keyup") {
      for (const pressed of _Keyboard.pressed.keys()) {
        const pressedKeys = pressed.split("+");
        if (!pressedKeys.includes(keys)) {
          continue;
        }
        const modifiedPressed = pressedKeys.filter((key) => key !== keys).join("+");
        _Keyboard.resolve(pressed, "keyup");
        _Keyboard.resolve(modifiedPressed, "keydown");
      }
    }
  } else {
    if (event.shiftKey) {
      keys = `Shift+${keys}`;
    }
    if (event.altKey) {
      keys = `Alt+${keys}`;
    }
    if (event.ctrlKey) {
      keys = `Control+${keys}`;
    }
    _Keyboard.resolve(keys, event.type);
  }
};

class MouseMapping {
  constructor() {
  }
  unmap() {
    Mouse.unmap(this);
  }
}

class Mouse {
  static initialize() {
    return this;
  }
  static terminate() {
  }
  static map() {
    const mapping = new MouseMapping();
    this.mappings.unshift(mapping);
    return mapping;
  }
  static unmap(mapping) {
    this.mappings = this.mappings.filter((m) => m !== mapping);
  }
  static update(deltaTime) {
  }
  static is(action) {
    return false;
  }
}
Mouse.mappings = [];

const _Input = class {
  static initialize(rps, rAF = true, element = document.body) {
    _Input.initialized = true;
    this.rps = rps;
    Keyboard.initialize(element);
    if (rAF === true) {
      let last;
      const start = (now) => {
        last = now;
        requestAnimationFrame(tick);
      };
      const tick = (now) => {
        const deltaTime = (now - last) / 1e3;
        last = now;
        _Input.update(deltaTime);
        requestAnimationFrame(tick);
      };
      requestAnimationFrame(start);
      return;
    }
    return this;
  }
  static terminate() {
    Keyboard.terminate();
  }
  static map(mappings, callback, effectMode = "interval", keymapMode = "add") {
    if (!_Input.initialized) {
      _Input.initialize(60);
    }
    return Keyboard.map(mappings, callback, effectMode, keymapMode);
  }
  static unmap(mapping) {
    if (mapping instanceof KeyboardMapping) {
      Keyboard.unmap(mapping);
    } else {
      Mouse.unmap(mapping);
    }
  }
  static update(deltaTime) {
    Keyboard.update(deltaTime);
  }
  static is(action) {
    if (!_Input.initialized) {
      _Input.initialize(60);
    }
    return Keyboard.is(action) || Mouse.is(action);
  }
};
let Input = _Input;
Input.initialized = false;

exports.Input = Input;
exports.Keyboard = Keyboard;
exports.KeyboardMapping = KeyboardMapping;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguY2pzIiwic291cmNlcyI6WyIuLi8uLi9zcmMva2V5Ym9hcmQtbWFwcGluZy50cyIsIi4uLy4uL3NyYy9rZXlib2FyZC50cyIsIi4uLy4uL3NyYy9tb3VzZS1tYXBwaW5nLnRzIiwiLi4vLi4vc3JjL21vdXNlLnRzIiwiLi4vLi4vc3JjL2lucHV0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElLZXlNYXBwaW5nLCBLZXlib2FyZCwgS2V5Q2FsbGJhY2ssIEtleUVmZmVjdE1vZGUsIEtleW1hcE1vZGUgfSBmcm9tIFwiLi9rZXlib2FyZFwiO1xuXG5leHBvcnQgY2xhc3MgS2V5Ym9hcmRNYXBwaW5nIHtcbiAgcHVibGljIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBtYXBwaW5nczogc3RyaW5nIHwgc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBJS2V5TWFwcGluZz4sXG4gICAgcHVibGljIGNhbGxiYWNrOiBLZXlDYWxsYmFjayB8IHVuZGVmaW5lZCxcbiAgICBwdWJsaWMgZWZmZWN0TW9kZTogS2V5RWZmZWN0TW9kZSxcbiAgICBwdWJsaWMga2V5bWFwTW9kZTogS2V5bWFwTW9kZSxcbiAgKSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzLm1hcHBpbmdzID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5tYXBwaW5ncyA9IFt0aGlzLm1hcHBpbmdzXTtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5tYXBwaW5ncykpIHtcbiAgICAgIHRoaXMubWFwcGluZ3MgPSBbLi4udGhpcy5tYXBwaW5nc10ucmVkdWNlKChtYXBwaW5ncywgdmFsdWUpID0+IHtcbiAgICAgICAgKG1hcHBpbmdzIGFzIGFueSlbdmFsdWVdID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBtYXBwaW5ncztcbiAgICAgIH0sIHt9KTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5tYXBwaW5ncykge1xuICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5tYXBwaW5nc1trZXldO1xuICAgICAgaWYgKHR5cGVvZiBhY3Rpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMubWFwcGluZ3Nba2V5XSA9IHtcbiAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICByZXBlYXQ6IHRydWUsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICB0aGlzLm1hcHBpbmdzW2tleV0ubWFwcGluZyA9IHRoaXM7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIG1hcHMoa2V5czogc3RyaW5nKTogSUtleU1hcHBpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiAodGhpcy5tYXBwaW5ncyBhcyBhbnkpW2tleXNdO1xuICB9XG5cbiAgcHVibGljIHVubWFwKCk6IHZvaWQge1xuICAgIEtleWJvYXJkLnVubWFwKHRoaXMpO1xuICB9XG5cbiAgLy8gcHVibGljIGFkZE1hcHBpbmcoa2V5czogc3RyaW5nIHwgc3RyaW5nW10sIGNhbGxiYWNrOiBLZXlDYWxsYmFjaykge1xuICAvLyAgIGlmICghQXJyYXkuaXNBcnJheShrZXlzKSkge1xuICAvLyAgICAga2V5cyA9IFtrZXlzXTtcbiAgLy8gICB9XG4gIC8vICAga2V5cy5mb3JFYWNoKGtleSA9PiB0aGlzLm1hcHBpbmdzLnNldChrZXksIGNhbGxiYWNrKSk7XG4gIC8vIH1cbiAgLy8gcHVibGljIHJlbW92ZU1hcHBpbmcoa2V5OiBzdHJpbmcpIHtcbiAgLy8gICB0aGlzLm1hcHBpbmdzLmRlbGV0ZShrZXkpO1xuICAvLyB9XG59XG4iLCJpbXBvcnQgeyBJbnB1dCB9IGZyb20gXCIuL2lucHV0XCI7XG5pbXBvcnQgeyBLZXlib2FyZE1hcHBpbmcgfSBmcm9tIFwiLi9rZXlib2FyZC1tYXBwaW5nXCI7XG5cbmV4cG9ydCB0eXBlIEtleUNhbGxiYWNrID0gKGtleTogc3RyaW5nLCBwcmVzc2VkOiBib29sZWFuLCBkZWx0YVRpbWU6IG51bWJlcikgPT4gdm9pZDtcbmV4cG9ydCB0eXBlIEtleW1hcE1vZGUgPSAnYWRkJyB8ICdyZXBsYWNlJztcbmV4cG9ydCB0eXBlIEtleUVmZmVjdE1vZGUgPSAnaW5zdGFudCcgfCAnaW50ZXJ2YWwnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElLZXlNYXBwaW5nIHtcbiAgYWN0aW9uOiBzdHJpbmc7XG4gIHJlcGVhdDogYm9vbGVhbjtcbiAgbWFwcGluZz86IEtleWJvYXJkTWFwcGluZztcbn1cbi8vIFRPRE86IEFkZCBzdXBwb3J0IGZvciBtdWx0aXBsZSBrZXlzIGZvciBvbmUgYWN0aW9uXG5leHBvcnQgY2xhc3MgS2V5Ym9hcmQge1xuICBwcml2YXRlIHN0YXRpYyBlbGVtZW50OiBIVE1MRWxlbWVudCB8IG51bGw7XG4gIHByaXZhdGUgc3RhdGljIG1hcHBpbmdzOiBLZXlib2FyZE1hcHBpbmdbXSA9IFtdO1xuICAvLyBwcml2YXRlIHN0YXRpYyBtYXBwaW5nczogTWFwPHN0cmluZywgS2V5Q2FsbGJhY2s+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBwcmVzc2VkOiBNYXA8c3RyaW5nLCB7IGtleW1hcDogSUtleU1hcHBpbmcsIHJlcGVhdDogbnVtYmVyLCBkb25lOiBib29sZWFuLCBkb25lSXM6IGJvb2xlYW4gfT4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgc3RhdGljIGxhc3RQcmVzc2VkOiBzdHJpbmdbXSA9IFtdO1xuXG4gIHB1YmxpYyBzdGF0aWMgaW5pdGlhbGl6ZShlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleUNoYW5nZSk7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5rZXlDaGFuZ2UpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyB0ZXJtaW5hdGUoKSB7XG4gICAgdGhpcy5lbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlDaGFuZ2UpO1xuICAgIHRoaXMuZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLmtleUNoYW5nZSk7XG4gICAgdGhpcy5lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbWFwKG1hcHBpbmdzOiBzdHJpbmcgfCBzdHJpbmdbXSB8IFJlY29yZDxzdHJpbmcsIElLZXlNYXBwaW5nPiwgY2FsbGJhY2s/OiBLZXlDYWxsYmFjaywgZWZmZWN0TW9kZTogS2V5RWZmZWN0TW9kZSA9ICdpbnRlcnZhbCcsIGtleW1hcE1vZGU6IEtleW1hcE1vZGUgPSAnYWRkJyk6IEtleWJvYXJkTWFwcGluZyB7XG4gICAgY29uc3QgbWFwcGluZyA9IG5ldyBLZXlib2FyZE1hcHBpbmcobWFwcGluZ3MsIGNhbGxiYWNrLCBlZmZlY3RNb2RlLCBrZXltYXBNb2RlKTtcbiAgICB0aGlzLm1hcHBpbmdzLnVuc2hpZnQobWFwcGluZyk7XG4gICAgcmV0dXJuIG1hcHBpbmc7XG4gIH1cbiAgcHVibGljIHN0YXRpYyB1bm1hcChtYXBwaW5nOiBLZXlib2FyZE1hcHBpbmcpOiB2b2lkIHtcbiAgICB0aGlzLm1hcHBpbmdzID0gdGhpcy5tYXBwaW5ncy5maWx0ZXIobSA9PiBtICE9PSBtYXBwaW5nKTtcbiAgICBmb3IgKGNvbnN0IGtleSBvZiB0aGlzLnByZXNzZWQua2V5cygpKSB7XG4gICAgICBpZiAodGhpcy5wcmVzc2VkLmdldChrZXkpPy5rZXltYXAubWFwcGluZyA9PT0gbWFwcGluZykge1xuICAgICAgICB0aGlzLnByZXNzZWQuZGVsZXRlKGtleSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMubGFzdFByZXNzZWQgPSBbLi4udGhpcy5wcmVzc2VkLmtleXMoKV07XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGtleUNoYW5nZSA9IChldmVudDogS2V5Ym9hcmRFdmVudCk6IHZvaWQgPT4ge1xuICAgIGxldCBrZXlzID0gZXZlbnQua2V5O1xuICAgIGlmIChbJ0NvbnRyb2wnLCAnQWx0JywgJ1NoaWZ0J10uaW5jbHVkZXMoa2V5cykpIHtcbiAgICAgIGlmIChldmVudC50eXBlID09PSAna2V5ZG93bicpIHtcbiAgICAgICAgZm9yIChjb25zdCBwcmVzc2VkIG9mIHRoaXMucHJlc3NlZC5rZXlzKCkpIHtcbiAgICAgICAgICBjb25zdCBwcmVzc2VkS2V5cyA9IHByZXNzZWQuc3BsaXQoJysnKTtcbiAgICAgICAgICBpZiAocHJlc3NlZEtleXMuaW5jbHVkZXMoa2V5cykpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsZXQgbW9kaWZpZWRQcmVzc2VkID0gcHJlc3NlZEtleXMucG9wKCk7XG4gICAgICAgICAgZm9yIChjb25zdCBtb2RpZmllciBvZiBbJ1NoaWZ0JywgJ0FsdCcsICdDb250cm9sJ10pIHtcbiAgICAgICAgICAgIGlmIChrZXlzID09PSBtb2RpZmllciB8fCBwcmVzc2VkS2V5cy5pbmNsdWRlcyhtb2RpZmllcikpIHtcbiAgICAgICAgICAgICAgbW9kaWZpZWRQcmVzc2VkID0gYCR7bW9kaWZpZXJ9KyR7bW9kaWZpZWRQcmVzc2VkfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgS2V5Ym9hcmQucmVzb2x2ZShwcmVzc2VkLCAna2V5dXAnKTtcbiAgICAgICAgICBLZXlib2FyZC5yZXNvbHZlKG1vZGlmaWVkUHJlc3NlZCBhcyBzdHJpbmcsICdrZXlkb3duJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZXZlbnQudHlwZSA9PT0gJ2tleXVwJykge1xuICAgICAgICBmb3IgKGNvbnN0IHByZXNzZWQgb2YgdGhpcy5wcmVzc2VkLmtleXMoKSkge1xuICAgICAgICAgIGNvbnN0IHByZXNzZWRLZXlzID0gcHJlc3NlZC5zcGxpdCgnKycpO1xuICAgICAgICAgIGlmICghcHJlc3NlZEtleXMuaW5jbHVkZXMoa2V5cykpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBtb2RpZmllZFByZXNzZWQgPSBwcmVzc2VkS2V5cy5maWx0ZXIoa2V5ID0+IGtleSAhPT0ga2V5cykuam9pbignKycpO1xuXG4gICAgICAgICAgS2V5Ym9hcmQucmVzb2x2ZShwcmVzc2VkLCAna2V5dXAnKTtcbiAgICAgICAgICBLZXlib2FyZC5yZXNvbHZlKG1vZGlmaWVkUHJlc3NlZCwgJ2tleWRvd24nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAga2V5cyA9IGBTaGlmdCske2tleXN9YDtcbiAgICAgIH1cbiAgICAgIGlmIChldmVudC5hbHRLZXkpIHtcbiAgICAgICAga2V5cyA9IGBBbHQrJHtrZXlzfWA7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQuY3RybEtleSkge1xuICAgICAgICBrZXlzID0gYENvbnRyb2wrJHtrZXlzfWA7XG4gICAgICB9XG4gICAgICBLZXlib2FyZC5yZXNvbHZlKGtleXMsIGV2ZW50LnR5cGUpO1xuICAgIH1cbiAgfTtcblxuICBwdWJsaWMgc3RhdGljIHJlc29sdmUoa2V5czogc3RyaW5nLCBldmVudFR5cGU6IHN0cmluZykge1xuICAgIGNvbnN0IG1hcHBlZCA9IHRoaXMubWFwcGVkKGtleXMpO1xuICAgIGlmIChtYXBwZWQgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChtYXBwZWQubWFwcGluZz8uZWZmZWN0TW9kZSA9PT0gJ2luc3RhbnQnKSB7XG4gICAgICBtYXBwZWQubWFwcGluZy5jYWxsYmFjaz8uKG1hcHBlZC5hY3Rpb24sIGV2ZW50VHlwZSA9PT0gJ2tleWRvd24nLCAwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZXZlbnRUeXBlID09PSAna2V5ZG93bicpIHtcbiAgICAgIGlmICghdGhpcy5wcmVzc2VkLmhhcyhrZXlzKSkge1xuICAgICAgICB0aGlzLnByZXNzZWQuc2V0KGtleXMsIHsga2V5bWFwOiBtYXBwZWQsIHJlcGVhdDogMCwgZG9uZTogZmFsc2UsIGRvbmVJczogZmFsc2UgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChldmVudFR5cGUgPT09ICdrZXl1cCcpIHtcbiAgICAgIHRoaXMucHJlc3NlZC5kZWxldGUoa2V5cyk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHN0YXRpYyB1cGRhdGUoZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICB0aGlzLnByZXNzZWQuZm9yRWFjaCgobWFwcGVkLCBrZXkpID0+IHtcbiAgICAgIGlmIChtYXBwZWQucmVwZWF0ID09PSAwIHx8IChtYXBwZWQua2V5bWFwLnJlcGVhdCAmJiBtYXBwZWQucmVwZWF0IDw9IDApKSB7XG4gICAgICAgIG1hcHBlZC5rZXltYXAubWFwcGluZz8uY2FsbGJhY2s/LihtYXBwZWQua2V5bWFwLmFjdGlvbiwgdHJ1ZSwgZGVsdGFUaW1lKTtcbiAgICAgICAgbWFwcGVkLnJlcGVhdCArPSBJbnB1dC5ycHM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnTk8gUkVQRUFUJywgbWFwcGVkLnJlcGVhdCk7XG4gICAgICAgIGlmICghbWFwcGVkLmtleW1hcC5yZXBlYXQpIHtcbiAgICAgICAgICBpZiAoIW1hcHBlZC5kb25lKSB7XG4gICAgICAgICAgICAvLyBtYXBwZWQua2V5bWFwLm1hcHBpbmcuY2FsbGJhY2sobWFwcGVkLmtleW1hcC5hY3Rpb24sIGZhbHNlLCBkZWx0YVRpbWUpO1xuICAgICAgICAgICAgbWFwcGVkLmRvbmUgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtYXBwZWQucmVwZWF0IC09IGRlbHRhVGltZSAqIDEwMDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmxhc3RQcmVzc2VkLmZvckVhY2goa2V5cyA9PiB7XG4gICAgICBpZiAoIXRoaXMucHJlc3NlZC5oYXMoa2V5cykpIHtcbiAgICAgICAgY29uc3QgbWFwcGVkID0gdGhpcy5tYXBwZWQoa2V5cyk7XG4gICAgICAgIG1hcHBlZD8ubWFwcGluZyEuY2FsbGJhY2s/LihtYXBwZWQuYWN0aW9uLCBmYWxzZSwgZGVsdGFUaW1lKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmxhc3RQcmVzc2VkID0gWy4uLnRoaXMucHJlc3NlZC5rZXlzKCldO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBtYXBwZWQoa2V5czogc3RyaW5nKTogSUtleU1hcHBpbmcgfCB1bmRlZmluZWQge1xuICAgIGxldCBtYXBwZWQ7XG4gICAgZm9yIChjb25zdCBtYXBwaW5nIG9mIHRoaXMubWFwcGluZ3MpIHtcbiAgICAgIG1hcHBlZCA9IG1hcHBpbmcubWFwcyhrZXlzKTtcbiAgICAgIGlmIChtYXBwZWQgIT0gbnVsbCB8fCBtYXBwaW5nLmtleW1hcE1vZGUgPT09ICdyZXBsYWNlJykge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1hcHBlZDtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgaXMoYWN0aW9uOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBmb3IgKGNvbnN0IHByZXNzZWQgb2YgdGhpcy5wcmVzc2VkLnZhbHVlcygpKSB7XG4gICAgICBpZiAocHJlc3NlZC5rZXltYXAuYWN0aW9uICE9PSBhY3Rpb24pIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAocHJlc3NlZC5yZXBlYXQgPT09IDAgfHwgKHByZXNzZWQua2V5bWFwLnJlcGVhdCAmJiBwcmVzc2VkLnJlcGVhdCA8PSAwKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghcHJlc3NlZC5rZXltYXAucmVwZWF0ICYmICFwcmVzc2VkLmRvbmVJcykge1xuICAgICAgICAgIHByZXNzZWQuZG9uZUlzID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsImltcG9ydCB7IE1vdXNlIH0gZnJvbSBcIi4vbW91c2VcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBNb3VzZU1hcHBpbmcge1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihcclxuICApIHtcclxuICB9XHJcbiAgcHVibGljIHVubWFwKCk6IHZvaWQge1xyXG4gICAgTW91c2UudW5tYXAodGhpcyk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IE1vdXNlTWFwcGluZyB9IGZyb20gXCIuL21vdXNlLW1hcHBpbmdcIjtcclxuXHJcbmV4cG9ydCB0eXBlIE1vdXNlQ2FsbGJhY2sgPSAoa2V5OiBzdHJpbmcsIHByZXNzZWQ6IGJvb2xlYW4sIGRlbHRhVGltZTogbnVtYmVyKSA9PiB2b2lkO1xyXG5leHBvcnQgdHlwZSBNb3VzZUVmZmVjdE1vZGUgPSAnaW5zdGFudCcgfCAnaW50ZXJ2YWwnO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1vdXNlIHtcclxuICBwcml2YXRlIHN0YXRpYyBtYXBwaW5nczogTW91c2VNYXBwaW5nW10gPSBbXTtcclxuXHJcbiAgcHVibGljIHN0YXRpYyBpbml0aWFsaXplKCkge1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIHRlcm1pbmF0ZSgpIHsgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIG1hcCgpOiBNb3VzZU1hcHBpbmcge1xyXG4gICAgY29uc3QgbWFwcGluZyA9IG5ldyBNb3VzZU1hcHBpbmcoKTtcclxuICAgIHRoaXMubWFwcGluZ3MudW5zaGlmdChtYXBwaW5nKTtcclxuICAgIHJldHVybiBtYXBwaW5nO1xyXG4gIH1cclxuICBwdWJsaWMgc3RhdGljIHVubWFwKG1hcHBpbmc6IE1vdXNlTWFwcGluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5tYXBwaW5ncyA9IHRoaXMubWFwcGluZ3MuZmlsdGVyKG0gPT4gbSAhPT0gbWFwcGluZyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIHVwZGF0ZShkZWx0YVRpbWU6IG51bWJlcikgeyB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgaXMoYWN0aW9uOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUtleU1hcHBpbmcsIEtleWJvYXJkLCBLZXlDYWxsYmFjaywgS2V5RWZmZWN0TW9kZSwgS2V5bWFwTW9kZSB9IGZyb20gXCIuL2tleWJvYXJkXCI7XG5pbXBvcnQgeyBLZXlib2FyZE1hcHBpbmcgfSBmcm9tIFwiLi9rZXlib2FyZC1tYXBwaW5nXCI7XG5pbXBvcnQgeyBNb3VzZSB9IGZyb20gXCIuL21vdXNlXCI7XG5pbXBvcnQgeyBNb3VzZU1hcHBpbmcgfSBmcm9tIFwiLi9tb3VzZS1tYXBwaW5nXCI7XG5cbmV4cG9ydCB0eXBlIElucHV0Q2FsbGJhY2sgPSBLZXlDYWxsYmFjaztcbmV4cG9ydCB0eXBlIElucHV0RWZmZWN0TW9kZSA9IEtleUVmZmVjdE1vZGU7XG5cbmV4cG9ydCBjbGFzcyBJbnB1dCB7XG4gIHByaXZhdGUgc3RhdGljIGluaXRpYWxpemVkID0gZmFsc2U7XG4gIHB1YmxpYyBzdGF0aWMgcnBzOiBudW1iZXI7XG5cbiAgcHVibGljIHN0YXRpYyBpbml0aWFsaXplKHJwczogbnVtYmVyLCByQUYgPSB0cnVlLCBlbGVtZW50ID0gZG9jdW1lbnQuYm9keSkge1xuICAgIElucHV0LmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICB0aGlzLnJwcyA9IHJwcztcbiAgICBLZXlib2FyZC5pbml0aWFsaXplKGVsZW1lbnQpO1xuICAgIE1vdXNlLmluaXRpYWxpemUoKTtcblxuICAgIGlmIChyQUYgPT09IHRydWUpIHtcbiAgICAgIGxldCBsYXN0OiBudW1iZXI7XG4gICAgICBjb25zdCBzdGFydCA9IChub3c6IG51bWJlcikgPT4ge1xuICAgICAgICBsYXN0ID0gbm93O1xuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGljayk7XG4gICAgICB9O1xuICAgICAgY29uc3QgdGljayA9IChub3c6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCBkZWx0YVRpbWUgPSAobm93IC0gbGFzdCkgLyAxMDAwO1xuICAgICAgICBsYXN0ID0gbm93O1xuICAgICAgICBJbnB1dC51cGRhdGUoZGVsdGFUaW1lKTtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spO1xuICAgICAgfTtcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShzdGFydCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyB0ZXJtaW5hdGUoKSB7XG4gICAgS2V5Ym9hcmQudGVybWluYXRlKCk7XG4gICAgTW91c2UudGVybWluYXRlKCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG1hcChtYXBwaW5nczogYW55LCBjYWxsYmFjaz86IElucHV0Q2FsbGJhY2ssIGVmZmVjdE1vZGU6IElucHV0RWZmZWN0TW9kZSA9ICdpbnRlcnZhbCcsIGtleW1hcE1vZGU6IEtleW1hcE1vZGUgPSAnYWRkJyk6IEtleWJvYXJkTWFwcGluZyB7XG4gICAgaWYgKCFJbnB1dC5pbml0aWFsaXplZCkge1xuICAgICAgSW5wdXQuaW5pdGlhbGl6ZSg2MCk7XG4gICAgfVxuICAgIHJldHVybiBLZXlib2FyZC5tYXAobWFwcGluZ3MsIGNhbGxiYWNrLCBlZmZlY3RNb2RlLCBrZXltYXBNb2RlKTtcbiAgfVxuICBwdWJsaWMgc3RhdGljIHVubWFwKG1hcHBpbmc6IEtleWJvYXJkTWFwcGluZyB8IE1vdXNlTWFwcGluZyk6IHZvaWQge1xuICAgIGlmIChtYXBwaW5nIGluc3RhbmNlb2YgS2V5Ym9hcmRNYXBwaW5nKSB7XG4gICAgICBLZXlib2FyZC51bm1hcChtYXBwaW5nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgTW91c2UudW5tYXAobWFwcGluZyk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHN0YXRpYyB1cGRhdGUoZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICBLZXlib2FyZC51cGRhdGUoZGVsdGFUaW1lKTtcbiAgICBNb3VzZS51cGRhdGUoZGVsdGFUaW1lKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgaXMoYWN0aW9uOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBpZiAoIUlucHV0LmluaXRpYWxpemVkKSB7XG4gICAgICBJbnB1dC5pbml0aWFsaXplKDYwKTtcbiAgICB9XG4gICAgcmV0dXJuIEtleWJvYXJkLmlzKGFjdGlvbikgfHwgTW91c2UuaXMoYWN0aW9uKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIm1hcHBpbmdzIl0sIm1hcHBpbmdzIjoiOzs7O0FBRU8sTUFBTSxlQUFnQixDQUFBO0FBQUEsRUFDcEIsV0FDRSxDQUFBLFFBQUEsRUFDQSxRQUNBLEVBQUEsVUFBQSxFQUNBLFVBQ1AsRUFBQTtBQUpPLElBQUEsSUFBQSxDQUFBLFFBQUEsR0FBQSxRQUFBLENBQUE7QUFDQSxJQUFBLElBQUEsQ0FBQSxRQUFBLEdBQUEsUUFBQSxDQUFBO0FBQ0EsSUFBQSxJQUFBLENBQUEsVUFBQSxHQUFBLFVBQUEsQ0FBQTtBQUNBLElBQUEsSUFBQSxDQUFBLFVBQUEsR0FBQSxVQUFBLENBQUE7QUFFUCxJQUFJLElBQUEsT0FBTyxJQUFLLENBQUEsUUFBQSxLQUFhLFFBQVUsRUFBQTtBQUNyQyxNQUFLLElBQUEsQ0FBQSxRQUFBLEdBQVcsQ0FBQyxJQUFBLENBQUssUUFBUSxDQUFBLENBQUE7QUFBQSxLQUNoQztBQUNBLElBQUEsSUFBSSxLQUFNLENBQUEsT0FBQSxDQUFRLElBQUssQ0FBQSxRQUFRLENBQUcsRUFBQTtBQUNoQyxNQUFLLElBQUEsQ0FBQSxRQUFBLEdBQVcsQ0FBQyxHQUFHLElBQUEsQ0FBSyxRQUFRLENBQUUsQ0FBQSxNQUFBLENBQU8sQ0FBQ0EsU0FBQUEsRUFBVSxLQUFVLEtBQUE7QUFDN0QsUUFBQ0EsVUFBaUIsS0FBUyxDQUFBLEdBQUEsS0FBQSxDQUFBO0FBQzNCLFFBQU9BLE9BQUFBLFNBQUFBLENBQUFBO0FBQUEsT0FDVCxFQUFHLEVBQUUsQ0FBQSxDQUFBO0FBQUEsS0FDUDtBQUNBLElBQVcsS0FBQSxNQUFBLEdBQUEsSUFBTyxLQUFLLFFBQVUsRUFBQTtBQUMvQixNQUFNLE1BQUEsTUFBQSxHQUFTLEtBQUssUUFBUyxDQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQzdCLE1BQUksSUFBQSxPQUFPLFdBQVcsUUFBVSxFQUFBO0FBQzlCLFFBQUEsSUFBQSxDQUFLLFNBQVMsR0FBTyxDQUFBLEdBQUE7QUFBQSxVQUNuQixNQUFBO0FBQUEsVUFDQSxNQUFRLEVBQUEsSUFBQTtBQUFBLFNBQ1YsQ0FBQTtBQUFBLE9BQ0Y7QUFDQSxNQUFLLElBQUEsQ0FBQSxRQUFBLENBQVMsS0FBSyxPQUFVLEdBQUEsSUFBQSxDQUFBO0FBQUEsS0FDL0I7QUFBQSxHQUNGO0FBQUEsRUFFTyxLQUFLLElBQXVDLEVBQUE7QUFDakQsSUFBQSxPQUFRLEtBQUssUUFBaUIsQ0FBQSxJQUFBLENBQUEsQ0FBQTtBQUFBLEdBQ2hDO0FBQUEsRUFFTyxLQUFjLEdBQUE7QUFDbkIsSUFBQSxRQUFBLENBQVMsTUFBTSxJQUFJLENBQUEsQ0FBQTtBQUFBLEdBQ3JCO0FBV0Y7O0FDbENPLE1BQU0sWUFBTixNQUFlO0FBQUEsRUFPcEIsT0FBYyxXQUFXLE9BQXNCLEVBQUE7QUFDN0MsSUFBQSxJQUFBLENBQUssT0FBVSxHQUFBLE9BQUEsQ0FBQTtBQUNmLElBQUEsSUFBQSxDQUFLLE9BQVEsQ0FBQSxnQkFBQSxDQUFpQixTQUFXLEVBQUEsSUFBQSxDQUFLLFNBQVMsQ0FBQSxDQUFBO0FBQ3ZELElBQUEsSUFBQSxDQUFLLE9BQVEsQ0FBQSxnQkFBQSxDQUFpQixPQUFTLEVBQUEsSUFBQSxDQUFLLFNBQVMsQ0FBQSxDQUFBO0FBQ3JELElBQU8sT0FBQSxJQUFBLENBQUE7QUFBQSxHQUNUO0FBQUEsRUFFQSxPQUFjLFNBQVksR0FBQTtBQUN4QixJQUFBLElBQUEsQ0FBSyxPQUFTLEVBQUEsbUJBQUEsQ0FBb0IsU0FBVyxFQUFBLElBQUEsQ0FBSyxTQUFTLENBQUEsQ0FBQTtBQUMzRCxJQUFBLElBQUEsQ0FBSyxPQUFTLEVBQUEsbUJBQUEsQ0FBb0IsT0FBUyxFQUFBLElBQUEsQ0FBSyxTQUFTLENBQUEsQ0FBQTtBQUN6RCxJQUFBLElBQUEsQ0FBSyxPQUFVLEdBQUEsSUFBQSxDQUFBO0FBQUEsR0FDakI7QUFBQSxFQUVBLE9BQWMsR0FBSSxDQUFBLFFBQUEsRUFBMkQsVUFBd0IsVUFBNEIsR0FBQSxVQUFBLEVBQVksYUFBeUIsS0FBd0IsRUFBQTtBQUM1TCxJQUFBLE1BQU0sVUFBVSxJQUFJLGVBQUEsQ0FBZ0IsUUFBVSxFQUFBLFFBQUEsRUFBVSxZQUFZLFVBQVUsQ0FBQSxDQUFBO0FBQzlFLElBQUssSUFBQSxDQUFBLFFBQUEsQ0FBUyxRQUFRLE9BQU8sQ0FBQSxDQUFBO0FBQzdCLElBQU8sT0FBQSxPQUFBLENBQUE7QUFBQSxHQUNUO0FBQUEsRUFDQSxPQUFjLE1BQU0sT0FBZ0MsRUFBQTtBQUNsRCxJQUFBLElBQUEsQ0FBSyxXQUFXLElBQUssQ0FBQSxRQUFBLENBQVMsTUFBTyxDQUFBLENBQUEsQ0FBQSxLQUFLLE1BQU0sT0FBTyxDQUFBLENBQUE7QUFDdkQsSUFBQSxLQUFBLE1BQVcsR0FBTyxJQUFBLElBQUEsQ0FBSyxPQUFRLENBQUEsSUFBQSxFQUFRLEVBQUE7QUFDckMsTUFBQSxJQUFJLEtBQUssT0FBUSxDQUFBLEdBQUEsQ0FBSSxHQUFHLENBQUcsRUFBQSxNQUFBLENBQU8sWUFBWSxPQUFTLEVBQUE7QUFDckQsUUFBSyxJQUFBLENBQUEsT0FBQSxDQUFRLE9BQU8sR0FBRyxDQUFBLENBQUE7QUFBQSxPQUN6QjtBQUFBLEtBQ0Y7QUFDQSxJQUFBLElBQUEsQ0FBSyxjQUFjLENBQUMsR0FBRyxJQUFLLENBQUEsT0FBQSxDQUFRLE1BQU0sQ0FBQSxDQUFBO0FBQUEsR0FDNUM7QUFBQSxFQStDQSxPQUFjLE9BQVEsQ0FBQSxJQUFBLEVBQWMsU0FBbUIsRUFBQTtBQUNyRCxJQUFNLE1BQUEsTUFBQSxHQUFTLElBQUssQ0FBQSxNQUFBLENBQU8sSUFBSSxDQUFBLENBQUE7QUFDL0IsSUFBQSxJQUFJLFVBQVUsSUFBTSxFQUFBO0FBQ2xCLE1BQUEsT0FBQTtBQUFBLEtBQ0Y7QUFFQSxJQUFJLElBQUEsTUFBQSxDQUFPLE9BQVMsRUFBQSxVQUFBLEtBQWUsU0FBVyxFQUFBO0FBQzVDLE1BQUEsTUFBQSxDQUFPLFFBQVEsUUFBVyxHQUFBLE1BQUEsQ0FBTyxNQUFRLEVBQUEsU0FBQSxLQUFjLFdBQVcsQ0FBQyxDQUFBLENBQUE7QUFDbkUsTUFBQSxPQUFBO0FBQUEsS0FDRjtBQUVBLElBQUEsSUFBSSxjQUFjLFNBQVcsRUFBQTtBQUMzQixNQUFBLElBQUksQ0FBQyxJQUFBLENBQUssT0FBUSxDQUFBLEdBQUEsQ0FBSSxJQUFJLENBQUcsRUFBQTtBQUMzQixRQUFBLElBQUEsQ0FBSyxPQUFRLENBQUEsR0FBQSxDQUFJLElBQU0sRUFBQSxFQUFFLE1BQVEsRUFBQSxNQUFBLEVBQVEsTUFBUSxFQUFBLENBQUEsRUFBRyxJQUFNLEVBQUEsS0FBQSxFQUFPLE1BQVEsRUFBQSxLQUFBLEVBQU8sQ0FBQSxDQUFBO0FBQUEsT0FDbEY7QUFBQSxLQUNGLE1BQUEsSUFBVyxjQUFjLE9BQVMsRUFBQTtBQUNoQyxNQUFLLElBQUEsQ0FBQSxPQUFBLENBQVEsT0FBTyxJQUFJLENBQUEsQ0FBQTtBQUFBLEtBQzFCO0FBQUEsR0FDRjtBQUFBLEVBRUEsT0FBYyxPQUFPLFNBQW1CLEVBQUE7QUFDdEMsSUFBQSxJQUFBLENBQUssT0FBUSxDQUFBLE9BQUEsQ0FBUSxDQUFDLE1BQUEsRUFBUSxHQUFRLEtBQUE7QUFDcEMsTUFBSSxJQUFBLE1BQUEsQ0FBTyxXQUFXLENBQU0sSUFBQSxNQUFBLENBQU8sT0FBTyxNQUFVLElBQUEsTUFBQSxDQUFPLFVBQVUsQ0FBSSxFQUFBO0FBQ3ZFLFFBQUEsTUFBQSxDQUFPLE9BQU8sT0FBUyxFQUFBLFFBQUEsR0FBVyxPQUFPLE1BQU8sQ0FBQSxNQUFBLEVBQVEsTUFBTSxTQUFTLENBQUEsQ0FBQTtBQUN2RSxRQUFBLE1BQUEsQ0FBTyxVQUFVLEtBQU0sQ0FBQSxHQUFBLENBQUE7QUFBQSxPQUNsQixNQUFBO0FBRUwsUUFBSSxJQUFBLENBQUMsTUFBTyxDQUFBLE1BQUEsQ0FBTyxNQUFRLEVBQUE7QUFDekIsVUFBSSxJQUFBLENBQUMsT0FBTyxJQUFNLEVBQUE7QUFFaEIsWUFBQSxNQUFBLENBQU8sSUFBTyxHQUFBLElBQUEsQ0FBQTtBQUFBLFdBQ2hCO0FBQUEsU0FDSyxNQUFBO0FBQ0wsVUFBQSxNQUFBLENBQU8sVUFBVSxTQUFZLEdBQUEsR0FBQSxDQUFBO0FBQUEsU0FDL0I7QUFBQSxPQUNGO0FBQUEsS0FDRCxDQUFBLENBQUE7QUFDRCxJQUFLLElBQUEsQ0FBQSxXQUFBLENBQVksUUFBUSxDQUFRLElBQUEsS0FBQTtBQUMvQixNQUFBLElBQUksQ0FBQyxJQUFBLENBQUssT0FBUSxDQUFBLEdBQUEsQ0FBSSxJQUFJLENBQUcsRUFBQTtBQUMzQixRQUFNLE1BQUEsTUFBQSxHQUFTLElBQUssQ0FBQSxNQUFBLENBQU8sSUFBSSxDQUFBLENBQUE7QUFDL0IsUUFBQSxNQUFBLEVBQVEsT0FBUyxDQUFBLFFBQUEsR0FBVyxNQUFPLENBQUEsTUFBQSxFQUFRLE9BQU8sU0FBUyxDQUFBLENBQUE7QUFBQSxPQUM3RDtBQUFBLEtBQ0QsQ0FBQSxDQUFBO0FBQ0QsSUFBQSxJQUFBLENBQUssY0FBYyxDQUFDLEdBQUcsSUFBSyxDQUFBLE9BQUEsQ0FBUSxNQUFNLENBQUEsQ0FBQTtBQUFBLEdBQzVDO0FBQUEsRUFFQSxPQUFjLE9BQU8sSUFBdUMsRUFBQTtBQUMxRCxJQUFJLElBQUEsTUFBQSxDQUFBO0FBQ0osSUFBVyxLQUFBLE1BQUEsT0FBQSxJQUFXLEtBQUssUUFBVSxFQUFBO0FBQ25DLE1BQVMsTUFBQSxHQUFBLE9BQUEsQ0FBUSxLQUFLLElBQUksQ0FBQSxDQUFBO0FBQzFCLE1BQUEsSUFBSSxNQUFVLElBQUEsSUFBQSxJQUFRLE9BQVEsQ0FBQSxVQUFBLEtBQWUsU0FBVyxFQUFBO0FBQ3RELFFBQUEsTUFBQTtBQUFBLE9BQ0Y7QUFBQSxLQUNGO0FBQ0EsSUFBTyxPQUFBLE1BQUEsQ0FBQTtBQUFBLEdBQ1Q7QUFBQSxFQUVBLE9BQWMsR0FBRyxNQUF5QixFQUFBO0FBQ3hDLElBQUEsS0FBQSxNQUFXLE9BQVcsSUFBQSxJQUFBLENBQUssT0FBUSxDQUFBLE1BQUEsRUFBVSxFQUFBO0FBQzNDLE1BQUksSUFBQSxPQUFBLENBQVEsTUFBTyxDQUFBLE1BQUEsS0FBVyxNQUFRLEVBQUE7QUFDcEMsUUFBQSxTQUFBO0FBQUEsT0FDRjtBQUNBLE1BQUksSUFBQSxPQUFBLENBQVEsV0FBVyxDQUFNLElBQUEsT0FBQSxDQUFRLE9BQU8sTUFBVSxJQUFBLE9BQUEsQ0FBUSxVQUFVLENBQUksRUFBQTtBQUMxRSxRQUFPLE9BQUEsSUFBQSxDQUFBO0FBQUEsT0FDRixNQUFBO0FBQ0wsUUFBQSxJQUFJLENBQUMsT0FBUSxDQUFBLE1BQUEsQ0FBTyxNQUFVLElBQUEsQ0FBQyxRQUFRLE1BQVEsRUFBQTtBQUM3QyxVQUFBLE9BQUEsQ0FBUSxNQUFTLEdBQUEsSUFBQSxDQUFBO0FBQ2pCLFVBQU8sT0FBQSxJQUFBLENBQUE7QUFBQSxTQUNUO0FBQUEsT0FDRjtBQUNBLE1BQU8sT0FBQSxLQUFBLENBQUE7QUFBQSxLQUNUO0FBQ0EsSUFBTyxPQUFBLEtBQUEsQ0FBQTtBQUFBLEdBQ1Q7QUFDRixDQUFBLENBQUE7QUExSk8sSUFBTSxRQUFOLEdBQUEsVUFBQTtBQUFNLFFBQUEsQ0FFSSxXQUE4QixFQUFDLENBQUE7QUFGbkMsUUFJYSxDQUFBLE9BQUEsdUJBQW9HLEdBQUksRUFBQSxDQUFBO0FBSnJILFFBQUEsQ0FLSSxjQUF3QixFQUFDLENBQUE7QUFMN0IsUUFtQ0csQ0FBQSxTQUFBLEdBQVksQ0FBQyxLQUErQixLQUFBO0FBQ3hELEVBQUEsSUFBSSxPQUFPLEtBQU0sQ0FBQSxHQUFBLENBQUE7QUFDakIsRUFBQSxJQUFJLENBQUMsU0FBVyxFQUFBLEtBQUEsRUFBTyxPQUFPLENBQUUsQ0FBQSxRQUFBLENBQVMsSUFBSSxDQUFHLEVBQUE7QUFDOUMsSUFBSSxJQUFBLEtBQUEsQ0FBTSxTQUFTLFNBQVcsRUFBQTtBQUM1QixNQUFBLEtBQUEsTUFBVyxPQUFXLElBQUEsU0FBQSxDQUFLLE9BQVEsQ0FBQSxJQUFBLEVBQVEsRUFBQTtBQUN6QyxRQUFNLE1BQUEsV0FBQSxHQUFjLE9BQVEsQ0FBQSxLQUFBLENBQU0sR0FBRyxDQUFBLENBQUE7QUFDckMsUUFBSSxJQUFBLFdBQUEsQ0FBWSxRQUFTLENBQUEsSUFBSSxDQUFHLEVBQUE7QUFDOUIsVUFBQSxTQUFBO0FBQUEsU0FDRjtBQUNBLFFBQUksSUFBQSxlQUFBLEdBQWtCLFlBQVksR0FBSSxFQUFBLENBQUE7QUFDdEMsUUFBQSxLQUFBLE1BQVcsUUFBWSxJQUFBLENBQUMsT0FBUyxFQUFBLEtBQUEsRUFBTyxTQUFTLENBQUcsRUFBQTtBQUNsRCxVQUFBLElBQUksSUFBUyxLQUFBLFFBQUEsSUFBWSxXQUFZLENBQUEsUUFBQSxDQUFTLFFBQVEsQ0FBRyxFQUFBO0FBQ3ZELFlBQUEsZUFBQSxHQUFrQixHQUFHLFFBQVksQ0FBQSxDQUFBLEVBQUEsZUFBQSxDQUFBLENBQUEsQ0FBQTtBQUFBLFdBQ25DO0FBQUEsU0FDRjtBQUVBLFFBQVMsU0FBQSxDQUFBLE9BQUEsQ0FBUSxTQUFTLE9BQU8sQ0FBQSxDQUFBO0FBQ2pDLFFBQVMsU0FBQSxDQUFBLE9BQUEsQ0FBUSxpQkFBMkIsU0FBUyxDQUFBLENBQUE7QUFBQSxPQUN2RDtBQUFBLEtBQ0YsTUFBQSxJQUFXLEtBQU0sQ0FBQSxJQUFBLEtBQVMsT0FBUyxFQUFBO0FBQ2pDLE1BQUEsS0FBQSxNQUFXLE9BQVcsSUFBQSxTQUFBLENBQUssT0FBUSxDQUFBLElBQUEsRUFBUSxFQUFBO0FBQ3pDLFFBQU0sTUFBQSxXQUFBLEdBQWMsT0FBUSxDQUFBLEtBQUEsQ0FBTSxHQUFHLENBQUEsQ0FBQTtBQUNyQyxRQUFBLElBQUksQ0FBQyxXQUFBLENBQVksUUFBUyxDQUFBLElBQUksQ0FBRyxFQUFBO0FBQy9CLFVBQUEsU0FBQTtBQUFBLFNBQ0Y7QUFDQSxRQUFNLE1BQUEsZUFBQSxHQUFrQixZQUFZLE1BQU8sQ0FBQSxDQUFBLEdBQUEsS0FBTyxRQUFRLElBQUksQ0FBQSxDQUFFLEtBQUssR0FBRyxDQUFBLENBQUE7QUFFeEUsUUFBUyxTQUFBLENBQUEsT0FBQSxDQUFRLFNBQVMsT0FBTyxDQUFBLENBQUE7QUFDakMsUUFBUyxTQUFBLENBQUEsT0FBQSxDQUFRLGlCQUFpQixTQUFTLENBQUEsQ0FBQTtBQUFBLE9BQzdDO0FBQUEsS0FDRjtBQUFBLEdBQ0ssTUFBQTtBQUNMLElBQUEsSUFBSSxNQUFNLFFBQVUsRUFBQTtBQUNsQixNQUFBLElBQUEsR0FBTyxDQUFTLE1BQUEsRUFBQSxJQUFBLENBQUEsQ0FBQSxDQUFBO0FBQUEsS0FDbEI7QUFDQSxJQUFBLElBQUksTUFBTSxNQUFRLEVBQUE7QUFDaEIsTUFBQSxJQUFBLEdBQU8sQ0FBTyxJQUFBLEVBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQTtBQUFBLEtBQ2hCO0FBQ0EsSUFBQSxJQUFJLE1BQU0sT0FBUyxFQUFBO0FBQ2pCLE1BQUEsSUFBQSxHQUFPLENBQVcsUUFBQSxFQUFBLElBQUEsQ0FBQSxDQUFBLENBQUE7QUFBQSxLQUNwQjtBQUNBLElBQVMsU0FBQSxDQUFBLE9BQUEsQ0FBUSxJQUFNLEVBQUEsS0FBQSxDQUFNLElBQUksQ0FBQSxDQUFBO0FBQUEsR0FDbkM7QUFDRixDQUFBOztBQ3pGSyxNQUFNLFlBQWEsQ0FBQTtBQUFBLEVBQ2pCLFdBQ0wsR0FBQTtBQUFBLEdBQ0Y7QUFBQSxFQUNPLEtBQWMsR0FBQTtBQUNuQixJQUFBLEtBQUEsQ0FBTSxNQUFNLElBQUksQ0FBQSxDQUFBO0FBQUEsR0FDbEI7QUFDRjs7QUNKTyxNQUFNLEtBQU0sQ0FBQTtBQUFBLEVBR2pCLE9BQWMsVUFBYSxHQUFBO0FBQ3pCLElBQU8sT0FBQSxJQUFBLENBQUE7QUFBQSxHQUNUO0FBQUEsRUFFQSxPQUFjLFNBQVksR0FBQTtBQUFBLEdBQUU7QUFBQSxFQUU1QixPQUFjLEdBQW9CLEdBQUE7QUFDaEMsSUFBTSxNQUFBLE9BQUEsR0FBVSxJQUFJLFlBQWEsRUFBQSxDQUFBO0FBQ2pDLElBQUssSUFBQSxDQUFBLFFBQUEsQ0FBUyxRQUFRLE9BQU8sQ0FBQSxDQUFBO0FBQzdCLElBQU8sT0FBQSxPQUFBLENBQUE7QUFBQSxHQUNUO0FBQUEsRUFDQSxPQUFjLE1BQU0sT0FBNkIsRUFBQTtBQUMvQyxJQUFBLElBQUEsQ0FBSyxXQUFXLElBQUssQ0FBQSxRQUFBLENBQVMsTUFBTyxDQUFBLENBQUEsQ0FBQSxLQUFLLE1BQU0sT0FBTyxDQUFBLENBQUE7QUFBQSxHQUN6RDtBQUFBLEVBRUEsT0FBYyxPQUFPLFNBQW1CLEVBQUE7QUFBQSxHQUFFO0FBQUEsRUFFMUMsT0FBYyxHQUFHLE1BQXlCLEVBQUE7QUFDeEMsSUFBTyxPQUFBLEtBQUEsQ0FBQTtBQUFBLEdBQ1Q7QUFDRixDQUFBO0FBdkJhLEtBQUEsQ0FDSSxXQUEyQixFQUFDOztBQ0V0QyxNQUFNLFNBQU4sTUFBWTtBQUFBLEVBSWpCLE9BQWMsVUFBVyxDQUFBLEdBQUEsRUFBYSxNQUFNLElBQU0sRUFBQSxPQUFBLEdBQVUsU0FBUyxJQUFNLEVBQUE7QUFDekUsSUFBQSxNQUFBLENBQU0sV0FBYyxHQUFBLElBQUEsQ0FBQTtBQUNwQixJQUFBLElBQUEsQ0FBSyxHQUFNLEdBQUEsR0FBQSxDQUFBO0FBQ1gsSUFBQSxRQUFBLENBQVMsV0FBVyxPQUFPLENBQUEsQ0FBQTtBQUczQixJQUFBLElBQUksUUFBUSxJQUFNLEVBQUE7QUFDaEIsTUFBSSxJQUFBLElBQUEsQ0FBQTtBQUNKLE1BQU0sTUFBQSxLQUFBLEdBQVEsQ0FBQyxHQUFnQixLQUFBO0FBQzdCLFFBQU8sSUFBQSxHQUFBLEdBQUEsQ0FBQTtBQUNQLFFBQUEscUJBQUEsQ0FBc0IsSUFBSSxDQUFBLENBQUE7QUFBQSxPQUM1QixDQUFBO0FBQ0EsTUFBTSxNQUFBLElBQUEsR0FBTyxDQUFDLEdBQWdCLEtBQUE7QUFDNUIsUUFBTSxNQUFBLFNBQUEsR0FBQSxDQUFhLE1BQU0sSUFBUSxJQUFBLEdBQUEsQ0FBQTtBQUNqQyxRQUFPLElBQUEsR0FBQSxHQUFBLENBQUE7QUFDUCxRQUFBLE1BQUEsQ0FBTSxPQUFPLFNBQVMsQ0FBQSxDQUFBO0FBQ3RCLFFBQUEscUJBQUEsQ0FBc0IsSUFBSSxDQUFBLENBQUE7QUFBQSxPQUM1QixDQUFBO0FBQ0EsTUFBQSxxQkFBQSxDQUFzQixLQUFLLENBQUEsQ0FBQTtBQUMzQixNQUFBLE9BQUE7QUFBQSxLQUNGO0FBQ0EsSUFBTyxPQUFBLElBQUEsQ0FBQTtBQUFBLEdBQ1Q7QUFBQSxFQUVBLE9BQWMsU0FBWSxHQUFBO0FBQ3hCLElBQUEsUUFBQSxDQUFTLFNBQVUsRUFBQSxDQUFBO0FBQ0gsR0FDbEI7QUFBQSxFQUVBLE9BQWMsR0FBSSxDQUFBLFFBQUEsRUFBZSxVQUEwQixVQUE4QixHQUFBLFVBQUEsRUFBWSxhQUF5QixLQUF3QixFQUFBO0FBQ3BKLElBQUksSUFBQSxDQUFDLE9BQU0sV0FBYSxFQUFBO0FBQ3RCLE1BQUEsTUFBQSxDQUFNLFdBQVcsRUFBRSxDQUFBLENBQUE7QUFBQSxLQUNyQjtBQUNBLElBQUEsT0FBTyxRQUFTLENBQUEsR0FBQSxDQUFJLFFBQVUsRUFBQSxRQUFBLEVBQVUsWUFBWSxVQUFVLENBQUEsQ0FBQTtBQUFBLEdBQ2hFO0FBQUEsRUFDQSxPQUFjLE1BQU0sT0FBK0MsRUFBQTtBQUNqRSxJQUFBLElBQUksbUJBQW1CLGVBQWlCLEVBQUE7QUFDdEMsTUFBQSxRQUFBLENBQVMsTUFBTSxPQUFPLENBQUEsQ0FBQTtBQUFBLEtBQ2pCLE1BQUE7QUFDTCxNQUFBLEtBQUEsQ0FBTSxNQUFNLE9BQU8sQ0FBQSxDQUFBO0FBQUEsS0FDckI7QUFBQSxHQUNGO0FBQUEsRUFFQSxPQUFjLE9BQU8sU0FBbUIsRUFBQTtBQUN0QyxJQUFBLFFBQUEsQ0FBUyxPQUFPLFNBQVMsQ0FBQSxDQUFBO0FBQ0gsR0FDeEI7QUFBQSxFQUVBLE9BQWMsR0FBRyxNQUF5QixFQUFBO0FBQ3hDLElBQUksSUFBQSxDQUFDLE9BQU0sV0FBYSxFQUFBO0FBQ3RCLE1BQUEsTUFBQSxDQUFNLFdBQVcsRUFBRSxDQUFBLENBQUE7QUFBQSxLQUNyQjtBQUNBLElBQUEsT0FBTyxTQUFTLEVBQUcsQ0FBQSxNQUFNLENBQUssSUFBQSxLQUFBLENBQU0sR0FBRyxNQUFNLENBQUEsQ0FBQTtBQUFBLEdBQy9DO0FBQ0YsQ0FBQSxDQUFBO0FBMURPLElBQU0sS0FBTixHQUFBLE9BQUE7QUFBTSxLQUFBLENBQ0ksV0FBYyxHQUFBLEtBQUE7Ozs7OzsifQ==
