'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

class KeyboardMapping {
  constructor(mappings, callback, effectMode, keymapMode) {
    this.mappings = mappings;
    this.callback = callback;
    this.effectMode = effectMode;
    this.keymapMode = keymapMode;
    if (typeof this.mappings === "string") {
      this.mappings = [this.mappings];
    }
    if (Array.isArray(this.mappings)) {
      this.mappings = [...this.mappings].reduce((mappings2, value) => {
        mappings2[value] = value;
        return mappings2;
      }, {});
    }
    for (const key in this.mappings) {
      const action = this.mappings[key];
      if (typeof action === "string") {
        this.mappings[key] = {
          action,
          repeat: true
        };
      }
      this.mappings[key].mapping = this;
    }
  }
  maps(keys) {
    return this.mappings[keys];
  }
  unmap() {
    Keyboard.unmap(this);
  }
}

const _Keyboard = class {
  static initialize(element) {
    this.element = element;
    this.element.addEventListener("keydown", this.keyChange);
    this.element.addEventListener("keyup", this.keyChange);
    return this;
  }
  static terminate() {
    this.element?.removeEventListener("keydown", this.keyChange);
    this.element?.removeEventListener("keyup", this.keyChange);
    this.element = null;
  }
  static map(mappings, callback, effectMode = "interval", keymapMode = "add") {
    const mapping = new KeyboardMapping(mappings, callback, effectMode, keymapMode);
    this.mappings.unshift(mapping);
    return mapping;
  }
  static unmap(mapping) {
    this.mappings = this.mappings.filter((m) => m !== mapping);
    for (const key of this.pressed.keys()) {
      if (this.pressed.get(key)?.keymap.mapping === mapping) {
        this.pressed.delete(key);
      }
    }
    this.lastPressed = [...this.pressed.keys()];
  }
  static resolve(keys, eventType) {
    const mapped = this.mapped(keys);
    if (mapped == null) {
      return;
    }
    if (mapped.mapping?.effectMode === "instant") {
      mapped.mapping.callback?.(mapped.action, eventType === "keydown", 0);
      return;
    }
    if (eventType === "keydown") {
      if (!this.pressed.has(keys)) {
        this.pressed.set(keys, { keymap: mapped, repeat: 0, done: false, doneIs: false });
      }
    } else if (eventType === "keyup") {
      this.pressed.delete(keys);
    }
  }
  static update(deltaTime) {
    this.pressed.forEach((mapped, key) => {
      if (mapped.repeat === 0 || mapped.keymap.repeat && mapped.repeat <= 0) {
        mapped.keymap.mapping?.callback?.(mapped.keymap.action, true, deltaTime);
        mapped.repeat += Input.rps;
      } else {
        if (!mapped.keymap.repeat) {
          if (!mapped.done) {
            mapped.done = true;
          }
        } else {
          mapped.repeat -= deltaTime * 1e3;
        }
      }
    });
    this.lastPressed.forEach((keys) => {
      if (!this.pressed.has(keys)) {
        const mapped = this.mapped(keys);
        mapped?.mapping.callback?.(mapped.action, false, deltaTime);
      }
    });
    this.lastPressed = [...this.pressed.keys()];
  }
  static mapped(keys) {
    let mapped;
    for (const mapping of this.mappings) {
      mapped = mapping.maps(keys);
      if (mapped != null || mapping.keymapMode === "replace") {
        break;
      }
    }
    return mapped;
  }
  static is(action) {
    for (const pressed of this.pressed.values()) {
      if (pressed.keymap.action !== action) {
        continue;
      }
      if (pressed.repeat === 0 || pressed.keymap.repeat && pressed.repeat <= 0) {
        return true;
      } else {
        if (!pressed.keymap.repeat && !pressed.doneIs) {
          pressed.doneIs = true;
          return true;
        }
      }
      return false;
    }
    return false;
  }
};
let Keyboard = _Keyboard;
Keyboard.mappings = [];
Keyboard.pressed = /* @__PURE__ */ new Map();
Keyboard.lastPressed = [];
Keyboard.keyChange = (event) => {
  let keys = event.key;
  if (["Control", "Alt", "Shift"].includes(keys)) {
    if (event.type === "keydown") {
      for (const pressed of _Keyboard.pressed.keys()) {
        const pressedKeys = pressed.split("+");
        if (pressedKeys.includes(keys)) {
          continue;
        }
        let modifiedPressed = pressedKeys.pop();
        for (const modifier of ["Shift", "Alt", "Control"]) {
          if (keys === modifier || pressedKeys.includes(modifier)) {
            modifiedPressed = `${modifier}+${modifiedPressed}`;
          }
        }
        _Keyboard.resolve(pressed, "keyup");
        _Keyboard.resolve(modifiedPressed, "keydown");
      }
    } else if (event.type === "keyup") {
      for (const pressed of _Keyboard.pressed.keys()) {
        const pressedKeys = pressed.split("+");
        if (!pressedKeys.includes(keys)) {
          continue;
        }
        const modifiedPressed = pressedKeys.filter((key) => key !== keys).join("+");
        _Keyboard.resolve(pressed, "keyup");
        _Keyboard.resolve(modifiedPressed, "keydown");
      }
    }
  } else {
    if (event.shiftKey) {
      keys = `Shift+${keys}`;
    }
    if (event.altKey) {
      keys = `Alt+${keys}`;
    }
    if (event.ctrlKey) {
      keys = `Control+${keys}`;
    }
    _Keyboard.resolve(keys, event.type);
  }
};

class MouseMapping {
  constructor() {
  }
  unmap() {
    Mouse.unmap(this);
  }
}

class Mouse {
  static initialize() {
    return this;
  }
  static terminate() {
  }
  static map() {
    const mapping = new MouseMapping();
    this.mappings.unshift(mapping);
    return mapping;
  }
  static unmap(mapping) {
    this.mappings = this.mappings.filter((m) => m !== mapping);
  }
  static update(deltaTime) {
  }
  static is(action) {
    return false;
  }
}
Mouse.mappings = [];

const _Input = class {
  static initialize(rps, rAF = true, element = document.body) {
    _Input.initialized = true;
    this.rps = rps;
    Keyboard.initialize(element);
    if (rAF === true) {
      let last;
      const start = (now) => {
        last = now;
        requestAnimationFrame(tick);
      };
      const tick = (now) => {
        const deltaTime = (now - last) / 1e3;
        last = now;
        _Input.update(deltaTime);
        requestAnimationFrame(tick);
      };
      requestAnimationFrame(start);
      return;
    }
    return this;
  }
  static terminate() {
    Keyboard.terminate();
  }
  static map(mappings, callback, effectMode = "interval", keymapMode = "add") {
    if (!_Input.initialized) {
      _Input.initialize(60);
    }
    return Keyboard.map(mappings, callback, effectMode, keymapMode);
  }
  static unmap(mapping) {
    if (mapping instanceof KeyboardMapping) {
      Keyboard.unmap(mapping);
    } else {
      Mouse.unmap(mapping);
    }
  }
  static update(deltaTime) {
    Keyboard.update(deltaTime);
  }
  static is(action) {
    if (!_Input.initialized) {
      _Input.initialize(60);
    }
    return Keyboard.is(action) || Mouse.is(action);
  }
};
let Input = _Input;
Input.initialized = false;

exports.Input = Input;
exports.Keyboard = Keyboard;
exports.KeyboardMapping = KeyboardMapping;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguZGV2LmNqcyIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2tleWJvYXJkLW1hcHBpbmcudHMiLCIuLi8uLi9zcmMva2V5Ym9hcmQudHMiLCIuLi8uLi9zcmMvbW91c2UtbWFwcGluZy50cyIsIi4uLy4uL3NyYy9tb3VzZS50cyIsIi4uLy4uL3NyYy9pbnB1dC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJS2V5TWFwcGluZywgS2V5Ym9hcmQsIEtleUNhbGxiYWNrLCBLZXlFZmZlY3RNb2RlLCBLZXltYXBNb2RlIH0gZnJvbSBcIi4va2V5Ym9hcmRcIjtcblxuZXhwb3J0IGNsYXNzIEtleWJvYXJkTWFwcGluZyB7XG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgbWFwcGluZ3M6IHN0cmluZyB8IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgSUtleU1hcHBpbmc+LFxuICAgIHB1YmxpYyBjYWxsYmFjazogS2V5Q2FsbGJhY2sgfCB1bmRlZmluZWQsXG4gICAgcHVibGljIGVmZmVjdE1vZGU6IEtleUVmZmVjdE1vZGUsXG4gICAgcHVibGljIGtleW1hcE1vZGU6IEtleW1hcE1vZGUsXG4gICkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5tYXBwaW5ncyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMubWFwcGluZ3MgPSBbdGhpcy5tYXBwaW5nc107XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMubWFwcGluZ3MpKSB7XG4gICAgICB0aGlzLm1hcHBpbmdzID0gWy4uLnRoaXMubWFwcGluZ3NdLnJlZHVjZSgobWFwcGluZ3MsIHZhbHVlKSA9PiB7XG4gICAgICAgIChtYXBwaW5ncyBhcyBhbnkpW3ZhbHVlXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gbWFwcGluZ3M7XG4gICAgICB9LCB7fSk7XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMubWFwcGluZ3MpIHtcbiAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMubWFwcGluZ3Nba2V5XTtcbiAgICAgIGlmICh0eXBlb2YgYWN0aW9uID09PSAnc3RyaW5nJykge1xuICAgICAgICB0aGlzLm1hcHBpbmdzW2tleV0gPSB7XG4gICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgcmVwZWF0OiB0cnVlLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgdGhpcy5tYXBwaW5nc1trZXldLm1hcHBpbmcgPSB0aGlzO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBtYXBzKGtleXM6IHN0cmluZyk6IElLZXlNYXBwaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gKHRoaXMubWFwcGluZ3MgYXMgYW55KVtrZXlzXTtcbiAgfVxuXG4gIHB1YmxpYyB1bm1hcCgpOiB2b2lkIHtcbiAgICBLZXlib2FyZC51bm1hcCh0aGlzKTtcbiAgfVxuXG4gIC8vIHB1YmxpYyBhZGRNYXBwaW5nKGtleXM6IHN0cmluZyB8IHN0cmluZ1tdLCBjYWxsYmFjazogS2V5Q2FsbGJhY2spIHtcbiAgLy8gICBpZiAoIUFycmF5LmlzQXJyYXkoa2V5cykpIHtcbiAgLy8gICAgIGtleXMgPSBba2V5c107XG4gIC8vICAgfVxuICAvLyAgIGtleXMuZm9yRWFjaChrZXkgPT4gdGhpcy5tYXBwaW5ncy5zZXQoa2V5LCBjYWxsYmFjaykpO1xuICAvLyB9XG4gIC8vIHB1YmxpYyByZW1vdmVNYXBwaW5nKGtleTogc3RyaW5nKSB7XG4gIC8vICAgdGhpcy5tYXBwaW5ncy5kZWxldGUoa2V5KTtcbiAgLy8gfVxufVxuIiwiaW1wb3J0IHsgSW5wdXQgfSBmcm9tIFwiLi9pbnB1dFwiO1xuaW1wb3J0IHsgS2V5Ym9hcmRNYXBwaW5nIH0gZnJvbSBcIi4va2V5Ym9hcmQtbWFwcGluZ1wiO1xuXG5leHBvcnQgdHlwZSBLZXlDYWxsYmFjayA9IChrZXk6IHN0cmluZywgcHJlc3NlZDogYm9vbGVhbiwgZGVsdGFUaW1lOiBudW1iZXIpID0+IHZvaWQ7XG5leHBvcnQgdHlwZSBLZXltYXBNb2RlID0gJ2FkZCcgfCAncmVwbGFjZSc7XG5leHBvcnQgdHlwZSBLZXlFZmZlY3RNb2RlID0gJ2luc3RhbnQnIHwgJ2ludGVydmFsJztcblxuZXhwb3J0IGludGVyZmFjZSBJS2V5TWFwcGluZyB7XG4gIGFjdGlvbjogc3RyaW5nO1xuICByZXBlYXQ6IGJvb2xlYW47XG4gIG1hcHBpbmc/OiBLZXlib2FyZE1hcHBpbmc7XG59XG4vLyBUT0RPOiBBZGQgc3VwcG9ydCBmb3IgbXVsdGlwbGUga2V5cyBmb3Igb25lIGFjdGlvblxuZXhwb3J0IGNsYXNzIEtleWJvYXJkIHtcbiAgcHJpdmF0ZSBzdGF0aWMgZWxlbWVudDogSFRNTEVsZW1lbnQgfCBudWxsO1xuICBwcml2YXRlIHN0YXRpYyBtYXBwaW5nczogS2V5Ym9hcmRNYXBwaW5nW10gPSBbXTtcbiAgLy8gcHJpdmF0ZSBzdGF0aWMgbWFwcGluZ3M6IE1hcDxzdHJpbmcsIEtleUNhbGxiYWNrPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgcHJlc3NlZDogTWFwPHN0cmluZywgeyBrZXltYXA6IElLZXlNYXBwaW5nLCByZXBlYXQ6IG51bWJlciwgZG9uZTogYm9vbGVhbiwgZG9uZUlzOiBib29sZWFuIH0+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHN0YXRpYyBsYXN0UHJlc3NlZDogc3RyaW5nW10gPSBbXTtcblxuICBwdWJsaWMgc3RhdGljIGluaXRpYWxpemUoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlDaGFuZ2UpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMua2V5Q2hhbmdlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdGVybWluYXRlKCkge1xuICAgIHRoaXMuZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5Q2hhbmdlKTtcbiAgICB0aGlzLmVsZW1lbnQ/LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5rZXlDaGFuZ2UpO1xuICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG1hcChtYXBwaW5nczogc3RyaW5nIHwgc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBJS2V5TWFwcGluZz4sIGNhbGxiYWNrPzogS2V5Q2FsbGJhY2ssIGVmZmVjdE1vZGU6IEtleUVmZmVjdE1vZGUgPSAnaW50ZXJ2YWwnLCBrZXltYXBNb2RlOiBLZXltYXBNb2RlID0gJ2FkZCcpOiBLZXlib2FyZE1hcHBpbmcge1xuICAgIGNvbnN0IG1hcHBpbmcgPSBuZXcgS2V5Ym9hcmRNYXBwaW5nKG1hcHBpbmdzLCBjYWxsYmFjaywgZWZmZWN0TW9kZSwga2V5bWFwTW9kZSk7XG4gICAgdGhpcy5tYXBwaW5ncy51bnNoaWZ0KG1hcHBpbmcpO1xuICAgIHJldHVybiBtYXBwaW5nO1xuICB9XG4gIHB1YmxpYyBzdGF0aWMgdW5tYXAobWFwcGluZzogS2V5Ym9hcmRNYXBwaW5nKTogdm9pZCB7XG4gICAgdGhpcy5tYXBwaW5ncyA9IHRoaXMubWFwcGluZ3MuZmlsdGVyKG0gPT4gbSAhPT0gbWFwcGluZyk7XG4gICAgZm9yIChjb25zdCBrZXkgb2YgdGhpcy5wcmVzc2VkLmtleXMoKSkge1xuICAgICAgaWYgKHRoaXMucHJlc3NlZC5nZXQoa2V5KT8ua2V5bWFwLm1hcHBpbmcgPT09IG1hcHBpbmcpIHtcbiAgICAgICAgdGhpcy5wcmVzc2VkLmRlbGV0ZShrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmxhc3RQcmVzc2VkID0gWy4uLnRoaXMucHJlc3NlZC5rZXlzKCldO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBrZXlDaGFuZ2UgPSAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkID0+IHtcbiAgICBsZXQga2V5cyA9IGV2ZW50LmtleTtcbiAgICBpZiAoWydDb250cm9sJywgJ0FsdCcsICdTaGlmdCddLmluY2x1ZGVzKGtleXMpKSB7XG4gICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2tleWRvd24nKSB7XG4gICAgICAgIGZvciAoY29uc3QgcHJlc3NlZCBvZiB0aGlzLnByZXNzZWQua2V5cygpKSB7XG4gICAgICAgICAgY29uc3QgcHJlc3NlZEtleXMgPSBwcmVzc2VkLnNwbGl0KCcrJyk7XG4gICAgICAgICAgaWYgKHByZXNzZWRLZXlzLmluY2x1ZGVzKGtleXMpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IG1vZGlmaWVkUHJlc3NlZCA9IHByZXNzZWRLZXlzLnBvcCgpO1xuICAgICAgICAgIGZvciAoY29uc3QgbW9kaWZpZXIgb2YgWydTaGlmdCcsICdBbHQnLCAnQ29udHJvbCddKSB7XG4gICAgICAgICAgICBpZiAoa2V5cyA9PT0gbW9kaWZpZXIgfHwgcHJlc3NlZEtleXMuaW5jbHVkZXMobW9kaWZpZXIpKSB7XG4gICAgICAgICAgICAgIG1vZGlmaWVkUHJlc3NlZCA9IGAke21vZGlmaWVyfSske21vZGlmaWVkUHJlc3NlZH1gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIEtleWJvYXJkLnJlc29sdmUocHJlc3NlZCwgJ2tleXVwJyk7XG4gICAgICAgICAgS2V5Ym9hcmQucmVzb2x2ZShtb2RpZmllZFByZXNzZWQgYXMgc3RyaW5nLCAna2V5ZG93bicpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09ICdrZXl1cCcpIHtcbiAgICAgICAgZm9yIChjb25zdCBwcmVzc2VkIG9mIHRoaXMucHJlc3NlZC5rZXlzKCkpIHtcbiAgICAgICAgICBjb25zdCBwcmVzc2VkS2V5cyA9IHByZXNzZWQuc3BsaXQoJysnKTtcbiAgICAgICAgICBpZiAoIXByZXNzZWRLZXlzLmluY2x1ZGVzKGtleXMpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbW9kaWZpZWRQcmVzc2VkID0gcHJlc3NlZEtleXMuZmlsdGVyKGtleSA9PiBrZXkgIT09IGtleXMpLmpvaW4oJysnKTtcblxuICAgICAgICAgIEtleWJvYXJkLnJlc29sdmUocHJlc3NlZCwgJ2tleXVwJyk7XG4gICAgICAgICAgS2V5Ym9hcmQucmVzb2x2ZShtb2RpZmllZFByZXNzZWQsICdrZXlkb3duJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGV2ZW50LnNoaWZ0S2V5KSB7XG4gICAgICAgIGtleXMgPSBgU2hpZnQrJHtrZXlzfWA7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQuYWx0S2V5KSB7XG4gICAgICAgIGtleXMgPSBgQWx0KyR7a2V5c31gO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAga2V5cyA9IGBDb250cm9sKyR7a2V5c31gO1xuICAgICAgfVxuICAgICAgS2V5Ym9hcmQucmVzb2x2ZShrZXlzLCBldmVudC50eXBlKTtcbiAgICB9XG4gIH07XG5cbiAgcHVibGljIHN0YXRpYyByZXNvbHZlKGtleXM6IHN0cmluZywgZXZlbnRUeXBlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBtYXBwZWQgPSB0aGlzLm1hcHBlZChrZXlzKTtcbiAgICBpZiAobWFwcGVkID09IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobWFwcGVkLm1hcHBpbmc/LmVmZmVjdE1vZGUgPT09ICdpbnN0YW50Jykge1xuICAgICAgbWFwcGVkLm1hcHBpbmcuY2FsbGJhY2s/LihtYXBwZWQuYWN0aW9uLCBldmVudFR5cGUgPT09ICdrZXlkb3duJywgMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2tleWRvd24nKSB7XG4gICAgICBpZiAoIXRoaXMucHJlc3NlZC5oYXMoa2V5cykpIHtcbiAgICAgICAgdGhpcy5wcmVzc2VkLnNldChrZXlzLCB7IGtleW1hcDogbWFwcGVkLCByZXBlYXQ6IDAsIGRvbmU6IGZhbHNlLCBkb25lSXM6IGZhbHNlIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZXZlbnRUeXBlID09PSAna2V5dXAnKSB7XG4gICAgICB0aGlzLnByZXNzZWQuZGVsZXRlKGtleXMpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgdGhpcy5wcmVzc2VkLmZvckVhY2goKG1hcHBlZCwga2V5KSA9PiB7XG4gICAgICBpZiAobWFwcGVkLnJlcGVhdCA9PT0gMCB8fCAobWFwcGVkLmtleW1hcC5yZXBlYXQgJiYgbWFwcGVkLnJlcGVhdCA8PSAwKSkge1xuICAgICAgICBtYXBwZWQua2V5bWFwLm1hcHBpbmc/LmNhbGxiYWNrPy4obWFwcGVkLmtleW1hcC5hY3Rpb24sIHRydWUsIGRlbHRhVGltZSk7XG4gICAgICAgIG1hcHBlZC5yZXBlYXQgKz0gSW5wdXQucnBzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ05PIFJFUEVBVCcsIG1hcHBlZC5yZXBlYXQpO1xuICAgICAgICBpZiAoIW1hcHBlZC5rZXltYXAucmVwZWF0KSB7XG4gICAgICAgICAgaWYgKCFtYXBwZWQuZG9uZSkge1xuICAgICAgICAgICAgLy8gbWFwcGVkLmtleW1hcC5tYXBwaW5nLmNhbGxiYWNrKG1hcHBlZC5rZXltYXAuYWN0aW9uLCBmYWxzZSwgZGVsdGFUaW1lKTtcbiAgICAgICAgICAgIG1hcHBlZC5kb25lID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWFwcGVkLnJlcGVhdCAtPSBkZWx0YVRpbWUgKiAxMDAwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5sYXN0UHJlc3NlZC5mb3JFYWNoKGtleXMgPT4ge1xuICAgICAgaWYgKCF0aGlzLnByZXNzZWQuaGFzKGtleXMpKSB7XG4gICAgICAgIGNvbnN0IG1hcHBlZCA9IHRoaXMubWFwcGVkKGtleXMpO1xuICAgICAgICBtYXBwZWQ/Lm1hcHBpbmchLmNhbGxiYWNrPy4obWFwcGVkLmFjdGlvbiwgZmFsc2UsIGRlbHRhVGltZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5sYXN0UHJlc3NlZCA9IFsuLi50aGlzLnByZXNzZWQua2V5cygpXTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbWFwcGVkKGtleXM6IHN0cmluZyk6IElLZXlNYXBwaW5nIHwgdW5kZWZpbmVkIHtcbiAgICBsZXQgbWFwcGVkO1xuICAgIGZvciAoY29uc3QgbWFwcGluZyBvZiB0aGlzLm1hcHBpbmdzKSB7XG4gICAgICBtYXBwZWQgPSBtYXBwaW5nLm1hcHMoa2V5cyk7XG4gICAgICBpZiAobWFwcGVkICE9IG51bGwgfHwgbWFwcGluZy5rZXltYXBNb2RlID09PSAncmVwbGFjZScpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXBwZWQ7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGlzKGFjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgZm9yIChjb25zdCBwcmVzc2VkIG9mIHRoaXMucHJlc3NlZC52YWx1ZXMoKSkge1xuICAgICAgaWYgKHByZXNzZWQua2V5bWFwLmFjdGlvbiAhPT0gYWN0aW9uKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHByZXNzZWQucmVwZWF0ID09PSAwIHx8IChwcmVzc2VkLmtleW1hcC5yZXBlYXQgJiYgcHJlc3NlZC5yZXBlYXQgPD0gMCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXByZXNzZWQua2V5bWFwLnJlcGVhdCAmJiAhcHJlc3NlZC5kb25lSXMpIHtcbiAgICAgICAgICBwcmVzc2VkLmRvbmVJcyA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG4iLCJpbXBvcnQgeyBNb3VzZSB9IGZyb20gXCIuL21vdXNlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTW91c2VNYXBwaW5nIHtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoXHJcbiAgKSB7XHJcbiAgfVxyXG4gIHB1YmxpYyB1bm1hcCgpOiB2b2lkIHtcclxuICAgIE1vdXNlLnVubWFwKHRoaXMpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBNb3VzZU1hcHBpbmcgfSBmcm9tIFwiLi9tb3VzZS1tYXBwaW5nXCI7XHJcblxyXG5leHBvcnQgdHlwZSBNb3VzZUNhbGxiYWNrID0gKGtleTogc3RyaW5nLCBwcmVzc2VkOiBib29sZWFuLCBkZWx0YVRpbWU6IG51bWJlcikgPT4gdm9pZDtcclxuZXhwb3J0IHR5cGUgTW91c2VFZmZlY3RNb2RlID0gJ2luc3RhbnQnIHwgJ2ludGVydmFsJztcclxuXHJcbmV4cG9ydCBjbGFzcyBNb3VzZSB7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgbWFwcGluZ3M6IE1vdXNlTWFwcGluZ1tdID0gW107XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgaW5pdGlhbGl6ZSgpIHtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyB0ZXJtaW5hdGUoKSB7IH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBtYXAoKTogTW91c2VNYXBwaW5nIHtcclxuICAgIGNvbnN0IG1hcHBpbmcgPSBuZXcgTW91c2VNYXBwaW5nKCk7XHJcbiAgICB0aGlzLm1hcHBpbmdzLnVuc2hpZnQobWFwcGluZyk7XHJcbiAgICByZXR1cm4gbWFwcGluZztcclxuICB9XHJcbiAgcHVibGljIHN0YXRpYyB1bm1hcChtYXBwaW5nOiBNb3VzZU1hcHBpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMubWFwcGluZ3MgPSB0aGlzLm1hcHBpbmdzLmZpbHRlcihtID0+IG0gIT09IG1hcHBpbmcpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyB1cGRhdGUoZGVsdGFUaW1lOiBudW1iZXIpIHsgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGlzKGFjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IElLZXlNYXBwaW5nLCBLZXlib2FyZCwgS2V5Q2FsbGJhY2ssIEtleUVmZmVjdE1vZGUsIEtleW1hcE1vZGUgfSBmcm9tIFwiLi9rZXlib2FyZFwiO1xuaW1wb3J0IHsgS2V5Ym9hcmRNYXBwaW5nIH0gZnJvbSBcIi4va2V5Ym9hcmQtbWFwcGluZ1wiO1xuaW1wb3J0IHsgTW91c2UgfSBmcm9tIFwiLi9tb3VzZVwiO1xuaW1wb3J0IHsgTW91c2VNYXBwaW5nIH0gZnJvbSBcIi4vbW91c2UtbWFwcGluZ1wiO1xuXG5leHBvcnQgdHlwZSBJbnB1dENhbGxiYWNrID0gS2V5Q2FsbGJhY2s7XG5leHBvcnQgdHlwZSBJbnB1dEVmZmVjdE1vZGUgPSBLZXlFZmZlY3RNb2RlO1xuXG5leHBvcnQgY2xhc3MgSW5wdXQge1xuICBwcml2YXRlIHN0YXRpYyBpbml0aWFsaXplZCA9IGZhbHNlO1xuICBwdWJsaWMgc3RhdGljIHJwczogbnVtYmVyO1xuXG4gIHB1YmxpYyBzdGF0aWMgaW5pdGlhbGl6ZShycHM6IG51bWJlciwgckFGID0gdHJ1ZSwgZWxlbWVudCA9IGRvY3VtZW50LmJvZHkpIHtcbiAgICBJbnB1dC5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgdGhpcy5ycHMgPSBycHM7XG4gICAgS2V5Ym9hcmQuaW5pdGlhbGl6ZShlbGVtZW50KTtcbiAgICBNb3VzZS5pbml0aWFsaXplKCk7XG5cbiAgICBpZiAockFGID09PSB0cnVlKSB7XG4gICAgICBsZXQgbGFzdDogbnVtYmVyO1xuICAgICAgY29uc3Qgc3RhcnQgPSAobm93OiBudW1iZXIpID0+IHtcbiAgICAgICAgbGFzdCA9IG5vdztcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spO1xuICAgICAgfTtcbiAgICAgIGNvbnN0IHRpY2sgPSAobm93OiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgZGVsdGFUaW1lID0gKG5vdyAtIGxhc3QpIC8gMTAwMDtcbiAgICAgICAgbGFzdCA9IG5vdztcbiAgICAgICAgSW5wdXQudXBkYXRlKGRlbHRhVGltZSk7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTtcbiAgICAgIH07XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc3RhcnQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdGVybWluYXRlKCkge1xuICAgIEtleWJvYXJkLnRlcm1pbmF0ZSgpO1xuICAgIE1vdXNlLnRlcm1pbmF0ZSgpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBtYXAobWFwcGluZ3M6IGFueSwgY2FsbGJhY2s/OiBJbnB1dENhbGxiYWNrLCBlZmZlY3RNb2RlOiBJbnB1dEVmZmVjdE1vZGUgPSAnaW50ZXJ2YWwnLCBrZXltYXBNb2RlOiBLZXltYXBNb2RlID0gJ2FkZCcpOiBLZXlib2FyZE1hcHBpbmcge1xuICAgIGlmICghSW5wdXQuaW5pdGlhbGl6ZWQpIHtcbiAgICAgIElucHV0LmluaXRpYWxpemUoNjApO1xuICAgIH1cbiAgICByZXR1cm4gS2V5Ym9hcmQubWFwKG1hcHBpbmdzLCBjYWxsYmFjaywgZWZmZWN0TW9kZSwga2V5bWFwTW9kZSk7XG4gIH1cbiAgcHVibGljIHN0YXRpYyB1bm1hcChtYXBwaW5nOiBLZXlib2FyZE1hcHBpbmcgfCBNb3VzZU1hcHBpbmcpOiB2b2lkIHtcbiAgICBpZiAobWFwcGluZyBpbnN0YW5jZW9mIEtleWJvYXJkTWFwcGluZykge1xuICAgICAgS2V5Ym9hcmQudW5tYXAobWFwcGluZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIE1vdXNlLnVubWFwKG1hcHBpbmcpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgS2V5Ym9hcmQudXBkYXRlKGRlbHRhVGltZSk7XG4gICAgTW91c2UudXBkYXRlKGRlbHRhVGltZSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGlzKGFjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgaWYgKCFJbnB1dC5pbml0aWFsaXplZCkge1xuICAgICAgSW5wdXQuaW5pdGlhbGl6ZSg2MCk7XG4gICAgfVxuICAgIHJldHVybiBLZXlib2FyZC5pcyhhY3Rpb24pIHx8IE1vdXNlLmlzKGFjdGlvbik7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJtYXBwaW5ncyJdLCJtYXBwaW5ncyI6Ijs7OztBQUVPLE1BQU0sZUFBZ0IsQ0FBQTtBQUFBLEVBQ3BCLFdBQ0UsQ0FBQSxRQUFBLEVBQ0EsUUFDQSxFQUFBLFVBQUEsRUFDQSxVQUNQLEVBQUE7QUFKTyxJQUFBLElBQUEsQ0FBQSxRQUFBLEdBQUEsUUFBQSxDQUFBO0FBQ0EsSUFBQSxJQUFBLENBQUEsUUFBQSxHQUFBLFFBQUEsQ0FBQTtBQUNBLElBQUEsSUFBQSxDQUFBLFVBQUEsR0FBQSxVQUFBLENBQUE7QUFDQSxJQUFBLElBQUEsQ0FBQSxVQUFBLEdBQUEsVUFBQSxDQUFBO0FBRVAsSUFBSSxJQUFBLE9BQU8sSUFBSyxDQUFBLFFBQUEsS0FBYSxRQUFVLEVBQUE7QUFDckMsTUFBSyxJQUFBLENBQUEsUUFBQSxHQUFXLENBQUMsSUFBQSxDQUFLLFFBQVEsQ0FBQSxDQUFBO0FBQUEsS0FDaEM7QUFDQSxJQUFBLElBQUksS0FBTSxDQUFBLE9BQUEsQ0FBUSxJQUFLLENBQUEsUUFBUSxDQUFHLEVBQUE7QUFDaEMsTUFBSyxJQUFBLENBQUEsUUFBQSxHQUFXLENBQUMsR0FBRyxJQUFBLENBQUssUUFBUSxDQUFFLENBQUEsTUFBQSxDQUFPLENBQUNBLFNBQUFBLEVBQVUsS0FBVSxLQUFBO0FB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
